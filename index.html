<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>里昂星储—查询系统</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --border-color: #bdc3c7;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        body {
            background-color: #f9f9f9;
            color: #333;
            transition: background-image 0.3s ease;
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* 头部样式 */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--border-color);
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo {
            width: 60px;
            height: 60px;
            border-radius: 8px;
            object-fit: cover;
            cursor: pointer;
            border: 2px solid var(--secondary-color);
            transition: transform 0.2s;
        }
        
        .logo:hover {
            transform: scale(1.05);
        }
        
        .logo-placeholder {
            width: 60px;
            height: 60px;
            background-color: var(--secondary-color);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            text-align: center;
        }
        
        h1 {
            color: var(--primary-color);
            font-size: 28px;
            font-weight: 700;
        }
        
        /* 标签页导航 */
        .tabs {
            display: flex;
            background-color: white;
            border-radius: 10px;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
            overflow: hidden;
            flex-wrap: wrap;
        }
        
        .tab {
            padding: 18px 25px;
            cursor: pointer;
            font-weight: 600;
            font-size: 16px;
            color: var(--dark-color);
            transition: all 0.3s ease;
            text-align: center;
            flex-grow: 1;
            border-bottom: 3px solid transparent;
        }
        
        .tab:hover {
            background-color: rgba(52, 152, 219, 0.1);
            color: var(--secondary-color);
        }
        
        .tab.active {
            background-color: rgba(52, 152, 219, 0.15);
            color: var(--secondary-color);
            border-bottom: 3px solid var(--secondary-color);
        }
        
        /* 内容区域 */
        .tab-content {
            display: none;
            background-color: white;
            border-radius: 10px;
            box-shadow: var(--shadow);
            padding: 30px;
            min-height: 500px;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .tab-content h2 {
            color: var(--primary-color);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }
        
        /* 图片显示区域 */
        .image-display {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 20px;
        }
        
        .image-item {
            max-width: 300px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        .image-item:hover {
            transform: translateY(-5px);
        }
        
        .image-item img {
            width: 100%;
            height: auto;
            display: block;
        }
        
        /* 模态框 */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background-color: white;
            border-radius: 10px;
            max-width: 90%;
            max-height: 90%;
            overflow: auto;
            position: relative;
        }
        
        .modal-content img {
            width: 100%;
            height: auto;
            display: block;
        }
        
        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            z-index: 1001;
        }
        
        /* 表格样式 */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        
        .data-table th, .data-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        .data-table th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: var(--primary-color);
        }
        
        .data-table tr:hover {
            background-color: #f9f9f9;
        }
        
        .status-in {
            background-color: rgba(39, 174, 96, 0.1);
            color: var(--success-color);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 14px;
        }
        
        .status-out {
            background-color: rgba(231, 76, 60, 0.1);
            color: var(--accent-color);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 14px;
        }
        
        /* 表单样式 */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-row {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .form-col {
            flex: 1;
            min-width: 200px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }
        
        input, select, button {
            padding: 12px 15px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 16px;
            width: 100%;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        button {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: background-color 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        button:hover {
            background-color: #2980b9;
        }
        
        .btn-danger {
            background-color: var(--accent-color);
        }
        
        .btn-danger:hover {
            background-color: #c0392b;
        }
        
        .btn-success {
            background-color: var(--success-color);
        }
        
        .btn-success:hover {
            background-color: #219653;
        }
        
        .btn-small {
            padding: 6px 12px;
            font-size: 14px;
        }
        
        /* 密码访问 */
        .password-container {
            max-width: 400px;
            margin: 100px auto;
            padding: 40px;
            background-color: white;
            border-radius: 10px;
            box-shadow: var(--shadow);
        }
        
        .password-container h3 {
            margin-bottom: 20px;
            text-align: center;
            color: var(--primary-color);
        }
        
        /* 上传区域 */
        .upload-section {
            margin-bottom: 30px;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }
        
        .upload-section h3 {
            margin-bottom: 15px;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .upload-area {
            border: 2px dashed #ccc;
            border-radius: 8px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 15px;
        }
        
        .upload-area:hover {
            border-color: var(--secondary-color);
            background-color: rgba(52, 152, 219, 0.05);
        }
        
        .upload-icon {
            font-size: 40px;
            color: var(--secondary-color);
            margin-bottom: 10px;
        }
        
        .file-list {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
        }
        
        .file-item {
            width: 120px;
            text-align: center;
        }
        
        .file-item img {
            width: 100%;
            height: 100px;
            object-fit: cover;
            border-radius: 6px;
            margin-bottom: 8px;
        }
        
        .file-actions {
            display: flex;
            gap: 5px;
            justify-content: center;
        }
        
        .no-data {
            text-align: center;
            padding: 40px;
            color: #777;
            font-size: 18px;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        
        .search-box {
            margin-bottom: 20px;
        }
        
        /* 响应式调整 */
        @media (max-width: 768px) {
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                border-bottom: 1px solid #eee;
            }
            
            .form-row {
                flex-direction: column;
            }
            
            .form-col {
                width: 100%;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .data-table {
                display: block;
                overflow-x: auto;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo-container">
                <div id="logoDisplay"></div>
                <h1>里昂星储—查询系统</h1>
            </div>
            <div id="currentTime" style="color: #666; font-weight: 500;"></div>
        </header>
        
        <!-- 标签页导航 -->
        <div class="tabs">
            <div class="tab active" data-tab="branch">网点清单</div>
            <div class="tab" data-tab="fee">资费清单</div>
            <div class="tab" data-tab="cabinet-info">在柜信息</div>
            <div class="tab" data-tab="cabinet-data">在柜数据访问</div>
            <div class="tab" data-tab="settings">设置</div>
            <div class="tab" data-tab="poke">戳戳我</div>
        </div>
        
        <!-- 网点清单标签页 -->
        <div id="branch" class="tab-content active">
            <h2><i class="fas fa-map-marked-alt"></i> 网点清单</h2>
            <div class="image-display" id="branchImagesContainer">
                <!-- 网点清单图片将在这里显示 -->
            </div>
        </div>
        
        <!-- 资费清单标签页 -->
        <div id="fee" class="tab-content">
            <h2><i class="fas fa-file-invoice-dollar"></i> 资费清单</h2>
            <div class="image-display" id="feeImagesContainer">
                <!-- 资费清单图片将在这里显示 -->
            </div>
        </div>
        
        <!-- 在柜信息标签页 -->
        <div id="cabinet-info" class="tab-content">
            <h2><i class="fas fa-inbox"></i> 在柜信息</h2>
            <div class="data-section">
                <div class="table-container">
                    <table class="data-table" id="cabinetInfoTable">
                        <thead>
                            <tr>
                                <th>区域</th>
                                <th>大区</th>
                                <th>编号</th>
                                <th>类型</th>
                                <th>存放位置</th>
                                <th>状态</th>
                            </tr>
                        </thead>
                        <tbody id="cabinetInfoBody">
                            <!-- 在柜信息数据将在这里显示 -->
                        </tbody>
                    </table>
                </div>
                <div id="cabinetInfoNoData" class="no-data">等待数据上传</div>
            </div>
            
            <h3 style="margin-top: 30px;"><i class="fas fa-user-check"></i> 取件人信息上传</h3>
            <div class="upload-section">
                <form id="pickupForm">
                    <div class="form-row">
                        <div class="form-col">
                            <label for="pickupNumber">待取件编号</label>
                            <input type="text" id="pickupNumber" required>
                        </div>
                        <div class="form-col">
                            <label for="pickupName">取件人姓名</label>
                            <input type="text" id="pickupName" required>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-col">
                            <label for="pickupPhone">联系电话</label>
                            <input type="tel" id="pickupPhone" required>
                        </div>
                        <div class="form-col">
                            <label for="pickupId">身份证明号码后四位</label>
                            <input type="text" id="pickupId" maxlength="4" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <button type="submit" class="btn-success">
                            <i class="fas fa-check"></i> 提交取件人信息
                        </button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- 在柜数据访问标签页 -->
        <div id="cabinet-data" class="tab-content">
            <!-- 密码访问区域 -->
            <div id="passwordSectionCabinet" class="password-container">
                <h3><i class="fas fa-lock"></i> 密码访问</h3>
                <p style="text-align: center; margin-bottom: 20px; color: #666;">请输入管理密码以访问在柜数据</p>
                <div class="form-group">
                    <input type="password" id="cabinetPassword" placeholder="请输入管理密码">
                </div>
                <button id="submitCabinetPassword" class="btn-success">提交密码</button>
            </div>
            
            <!-- 数据访问内容（默认隐藏） -->
            <div id="cabinetDataContent" style="display: none;">
                <h2><i class="fas fa-database"></i> 在柜数据访问</h2>
                
                <h3><i class="fas fa-plus-circle"></i> 添加在柜数据</h3>
                <div class="upload-section">
                    <form id="cabinetDataForm">
                        <div class="form-row">
                            <div class="form-col">
                                <label for="area">区域</label>
                                <input type="text" id="area" required>
                            </div>
                            <div class="form-col">
                                <label for="district">大区</label>
                                <input type="text" id="district" required>
                            </div>
                            <div class="form-col">
                                <label for="number">编号</label>
                                <input type="text" id="number" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-col">
                                <label for="type">类型</label>
                                <select id="type" required>
                                    <option value="">请选择类型</option>
                                    <option value="平信">平信</option>
                                    <option value="明信片">明信片</option>
                                    <option value="包裹">包裹</option>
                                </select>
                            </div>
                            <div class="form-col">
                                <label for="location">存放位置（柜号）</label>
                                <input type="text" id="location" required>
                            </div>
                            <div class="form-col">
                                <label for="status">状态</label>
                                <select id="status" required>
                                    <option value="">请选择状态</option>
                                    <option value="已入柜">已入柜</option>
                                    <option value="已出柜">已出柜</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <button type="submit" class="btn-success">
                                <i class="fas fa-plus"></i> 添加在柜数据
                            </button>
                        </div>
                    </form>
                </div>
                
                <h3><i class="fas fa-table"></i> 在柜数据</h3>
                <div class="search-box">
                    <input type="text" id="searchCabinetData" placeholder="搜索在柜数据...">
                </div>
                <div class="table-container">
                    <table class="data-table" id="cabinetDataTable">
                        <thead>
                            <tr>
                                <th>区域</th>
                                <th>大区</th>
                                <th>编号</th>
                                <th>类型</th>
                                <th>存放位置</th>
                                <th>状态</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="cabinetDataBody">
                            <!-- 在柜数据将在这里显示 -->
                        </tbody>
                    </table>
                </div>
                <div id="cabinetDataNoData" class="no-data">等待数据上传</div>
                
                <h3 style="margin-top: 30px;"><i class="fas fa-users"></i> 取件人信息</h3>
                <div class="search-box">
                    <input type="text" id="searchPickupData" placeholder="搜索取件人信息...">
                </div>
                <div class="table-container">
                    <table class="data-table" id="pickupDataTable">
                        <thead>
                            <tr>
                                <th>待取件编号</th>
                                <th>取件人姓名</th>
                                <th>联系电话</th>
                                <th>身份证明号码后四位</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="pickupDataBody">
                            <!-- 取件人信息将在这里显示 -->
                        </tbody>
                    </table>
                </div>
                <div id="pickupDataNoData" class="no-data">等待数据上传</div>
            </div>
        </div>
        
        <!-- 设置标签页 -->
        <div id="settings" class="tab-content">
            <!-- 密码访问区域 -->
            <div id="passwordSectionSettings" class="password-container">
                <h3><i class="fas fa-lock"></i> 密码访问</h3>
                <p style="text-align: center; margin-bottom: 20px; color: #666;">请输入管理密码以访问设置页面</p>
                <div class="form-group">
                    <input type="password" id="settingsPassword" placeholder="请输入管理密码">
                </div>
                <button id="submitSettingsPassword" class="btn-success">提交密码</button>
            </div>
            
            <!-- 设置内容（默认隐藏） -->
            <div id="settingsContent" style="display: none;">
                <h2><i class="fas fa-cog"></i> 设置</h2>
                
                <!-- LOGO上传 -->
                <div class="upload-section">
                    <h3><i class="fas fa-image"></i> LOGO上传</h3>
                    <p>支持格式: JPG, JPEG, PNG | 建议尺寸: 75cm x 75cm</p>
                    <div class="upload-area" id="logoUploadArea">
                        <div class="upload-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <p>点击或拖拽上传LOGO图片</p>
                        <p style="font-size: 14px; color: #777;">文件大小不超过5MB</p>
                    </div>
                    <input type="file" id="logoUpload" accept=".jpg,.jpeg,.png" style="display: none;">
                    <div id="logoPreview" class="file-list"></div>
                </div>
                
                <!-- 背景上传 -->
                <div class="upload-section">
                    <h3><i class="fas fa-image"></i> 背景上传</h3>
                    <p>支持格式: JPG, JPEG, PNG</p>
                    <div class="upload-area" id="bgUploadArea">
                        <div class="upload-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <p>点击或拖拽上传背景图片</p>
                        <p style="font-size: 14px; color: #777;">文件大小不超过5MB</p>
                    </div>
                    <input type="file" id="bgUpload" accept=".jpg,.jpeg,.png" style="display: none;">
                    <div id="bgPreview" class="file-list"></div>
                </div>
                
                <!-- 网点清单上传 -->
                <div class="upload-section">
                    <h3><i class="fas fa-map-marked-alt"></i> 网点清单图片上传</h3>
                    <p>支持格式: JPG, JPEG, PNG | 最多上传5张图片</p>
                    <div class="upload-area" id="branchUploadArea">
                        <div class="upload-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <p>点击或拖拽上传网点清单图片</p>
                        <p style="font-size: 14px; color: #777;">最多5张，每张不超过5MB</p>
                    </div>
                    <input type="file" id="branchUpload" accept=".jpg,.jpeg,.png" multiple style="display: none;">
                    <div id="branchPreview" class="file-list"></div>
                </div>
                
                <!-- 资费清单上传 -->
                <div class="upload-section">
                    <h3><i class="fas fa-file-invoice-dollar"></i> 资费清单图片上传</h3>
                    <p>支持格式: JPG, JPEG, PNG | 最多上传5张图片</p>
                    <div class="upload-area" id="feeUploadArea">
                        <div class="upload-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <p>点击或拖拽上传资费清单图片</p>
                        <p style="font-size: 14px; color: #777;">最多5张，每张不超过5MB</p>
                    </div>
                    <input type="file" id="feeUpload" accept=".jpg,.jpeg,.png" multiple style="display: none;">
                    <div id="feePreview" class="file-list"></div>
                </div>
                
                <!-- 戳戳我图片上传 -->
                <div class="upload-section">
                    <h3><i class="fas fa-smile"></i> 戳戳我图片上传</h3>
                    <p>支持格式: JPG, JPEG, PNG</p>
                    <div class="upload-area" id="pokeUploadArea">
                        <div class="upload-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <p>点击或拖拽上传戳戳我图片</p>
                        <p style="font-size: 14px; color: #777;">文件大小不超过5MB</p>
                    </div>
                    <input type="file" id="pokeUpload" accept=".jpg,.jpeg,.png" style="display: none;">
                    <div id="pokePreview" class="file-list"></div>
                </div>
            </div>
        </div>
        
        <!-- 戳戳我标签页 -->
        <div id="poke" class="tab-content">
            <h2><i class="fas fa-smile"></i> 戳戳我</h2>
            <div class="image-display" id="pokeImagesContainer">
                <!-- 戳戳我图片将在这里显示 -->
            </div>
        </div>
    </div>
    
    <!-- 图片查看模态框 -->
    <div id="imageModal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <img id="modalImage" src="" alt="预览图片">
        </div>
    </div>
    
    <!-- 成功提示 -->
    <div id="successToast" style="display:none; position: fixed; top: 20px; right: 20px; background-color: var(--success-color); color: white; padding: 15px 25px; border-radius: 5px; z-index: 1001; box-shadow: var(--shadow);">
        <i class="fas fa-check-circle"></i> 操作成功！
    </div>
    
    <script>
        // 页面加载时初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 初始化时间显示
            updateTime();
            setInterval(updateTime, 1000);
            
            // 初始化标签页切换
            initTabs();
            
            // 初始化数据
            initData();
            
            // 初始化事件监听器
            initEventListeners();
            
            // 恢复之前的标签页
            restoreActiveTab();
            
            // 加载背景
            loadBackground();
            
            // 加载LOGO
            loadLogo();
            
            // 加载图片到各个标签页
            loadImagesToTabs();
            
            // 加载在柜数据
            loadCabinetData();
            
            // 加载取件人信息
            loadPickupData();
        });
        
        // 更新时间显示
        function updateTime() {
            const now = new Date();
            const dateStr = now.toLocaleDateString('zh-CN', { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                weekday: 'long'
            });
            const timeStr = now.toLocaleTimeString('zh-CN');
            document.getElementById('currentTime').textContent = `${dateStr} ${timeStr}`;
        }
        
        // 标签页切换功能
        function initTabs() {
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    // 更新标签页状态
                    tabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // 更新内容显示
                    document.querySelectorAll('.tab-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    document.getElementById(tabId).classList.add('active');
                    
                    // 保存当前标签页到localStorage
                    localStorage.setItem('activeTab', tabId);
                });
            });
        }
        
        // 恢复之前的标签页
        function restoreActiveTab() {
            const activeTab = localStorage.getItem('activeTab') || 'branch';
            const tabElement = document.querySelector(`.tab[data-tab="${activeTab}"]`);
            if (tabElement) {
                tabElement.click();
            }
        }
        
        // 初始化数据
        function initData() {
            // 初始化localStorage数据
            if (!localStorage.getItem('branchImages')) {
                localStorage.setItem('branchImages', JSON.stringify([]));
            }
            
            if (!localStorage.getItem('feeImages')) {
                localStorage.setItem('feeImages', JSON.stringify([]));
            }
            
            if (!localStorage.getItem('pokeImages')) {
                localStorage.setItem('pokeImages', JSON.stringify([]));
            }
            
            if (!localStorage.getItem('cabinetData')) {
                localStorage.setItem('cabinetData', JSON.stringify([]));
            }
            
            if (!localStorage.getItem('pickupData')) {
                localStorage.setItem('pickupData', JSON.stringify([]));
            }
            
            if (!localStorage.getItem('logo')) {
                localStorage.setItem('logo', '');
            }
            
            if (!localStorage.getItem('background')) {
                localStorage.setItem('background', '');
            }
        }
        
        // 初始化事件监听器
        function initEventListeners() {
            // 图片查看模态框
            const modal = document.getElementById('imageModal');
            const modalImg = document.getElementById('modalImage');
            const closeModal = document.querySelector('.close-modal');
            
            // 点击图片放大
            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('viewable-image')) {
                    modalImg.src = e.target.src;
                    modal.classList.add('active');
                }
            });
            
            // 关闭模态框
            closeModal.addEventListener('click', function() {
                modal.classList.remove('active');
            });
            
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    modal.classList.remove('active');
                }
            });
            
            // 取件人信息表单提交
            document.getElementById('pickupForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const pickupData = {
                    pickupNumber: document.getElementById('pickupNumber').value,
                    pickupName: document.getElementById('pickupName').value,
                    pickupPhone: document.getElementById('pickupPhone').value,
                    pickupId: document.getElementById('pickupId').value
                };
                
                // 保存到localStorage
                const existingData = JSON.parse(localStorage.getItem('pickupData')) || [];
                existingData.push({
                    ...pickupData,
                    id: Date.now() // 使用时间戳作为ID
                });
                localStorage.setItem('pickupData', JSON.stringify(existingData));
                
                // 清空表单
                this.reset();
                
                // 显示成功提示
                showSuccessToast();
                
                // 重新加载取件人数据
                loadPickupData();
            });
            
            // 在柜数据表单提交
            document.getElementById('cabinetDataForm').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const cabinetData = {
                    area: document.getElementById('area').value,
                    district: document.getElementById('district').value,
                    number: document.getElementById('number').value,
                    type: document.getElementById('type').value,
                    location: document.getElementById('location').value,
                    status: document.getElementById('status').value
                };
                
                // 保存到localStorage
                const existingData = JSON.parse(localStorage.getItem('cabinetData')) || [];
                existingData.push({
                    ...cabinetData,
                    id: Date.now() // 使用时间戳作为ID
                });
                localStorage.setItem('cabinetData', JSON.stringify(existingData));
                
                // 清空表单
                this.reset();
                
                // 显示成功提示
                showSuccessToast();
                
                // 重新加载在柜数据
                loadCabinetData();
            });
            
            // 密码访问 - 在柜数据访问
            document.getElementById('submitCabinetPassword').addEventListener('click', function() {
                const password = document.getElementById('cabinetPassword').value;
                if (password === '740302') {
                    document.getElementById('passwordSectionCabinet').style.display = 'none';
                    document.getElementById('cabinetDataContent').style.display = 'block';
                } else {
                    alert('密码错误！');
                }
            });
            
            // 密码访问 - 设置
            document.getElementById('submitSettingsPassword').addEventListener('click', function() {
                const password = document.getElementById('settingsPassword').value;
                if (password === '740302') {
                    document.getElementById('passwordSectionSettings').style.display = 'none';
                    document.getElementById('settingsContent').style.display = 'block';
                } else {
                    alert('密码错误！');
                }
            });
            
            // 搜索功能
            document.getElementById('searchCabinetData').addEventListener('input', function() {
                searchCabinetData(this.value);
            });
            
            document.getElementById('searchPickupData').addEventListener('input', function() {
                searchPickupData(this.value);
            });
            
            // 文件上传功能
            initUploadFunctions();
        }
        
        // 初始化文件上传功能
        function initUploadFunctions() {
            // LOGO上传
            const logoUpload = document.getElementById('logoUpload');
            const logoUploadArea = document.getElementById('logoUploadArea');
            
            logoUploadArea.addEventListener('click', () => logoUpload.click());
            logoUpload.addEventListener('change', function() {
                handleLogoUpload(this.files[0]);
            });
            
            // 背景上传
            const bgUpload = document.getElementById('bgUpload');
            const bgUploadArea = document.getElementById('bgUploadArea');
            
            bgUploadArea.addEventListener('click', () => bgUpload.click());
            bgUpload.addEventListener('change', function() {
                handleBgUpload(this.files[0]);
            });
            
            // 网点清单上传
            const branchUpload = document.getElementById('branchUpload');
            const branchUploadArea = document.getElementById('branchUploadArea');
            
            branchUploadArea.addEventListener('click', () => branchUpload.click());
            branchUpload.addEventListener('change', function() {
                handleMultipleImageUpload(this.files, 'branchImages');
            });
            
            // 资费清单上传
            const feeUpload = document.getElementById('feeUpload');
            const feeUploadArea = document.getElementById('feeUploadArea');
            
            feeUploadArea.addEventListener('click', () => feeUpload.click());
            feeUpload.addEventListener('change', function() {
                handleMultipleImageUpload(this.files, 'feeImages');
            });
            
            // 戳戳我上传
            const pokeUpload = document.getElementById('pokeUpload');
            const pokeUploadArea = document.getElementById('pokeUploadArea');
            
            pokeUploadArea.addEventListener('click', () => pokeUpload.click());
            pokeUpload.addEventListener('change', function() {
                handlePokeUpload(this.files[0]);
            });
        }
        
        // 处理LOGO上传
        function handleLogoUpload(file) {
            if (!file) return;
            
            if (!file.type.match('image/jpeg') && !file.type.match('image/jpg') && !file.type.match('image/png')) {
                alert('只支持JPG、JPEG、PNG格式的图片！');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const imageData = e.target.result;
                localStorage.setItem('logo', imageData);
                loadLogo();
                showSuccessToast();
            };
            reader.readAsDataURL(file);
        }
        
        // 处理背景上传
        function handleBgUpload(file) {
            if (!file) return;
            
            if (!file.type.match('image/jpeg') && !file.type.match('image/jpg') && !file.type.match('image/png')) {
                alert('只支持JPG、JPEG、PNG格式的图片！');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const imageData = e.target.result;
                localStorage.setItem('background', imageData);
                loadBackground();
                showSuccessToast();
            };
            reader.readAsDataURL(file);
        }
        
        // 处理多图片上传
        function handleMultipleImageUpload(files, storageKey) {
            if (!files || files.length === 0) return;
            
            const maxImages = 5;
            const existingImages = JSON.parse(localStorage.getItem(storageKey)) || [];
            const remainingSlots = maxImages - existingImages.length;
            
            if (remainingSlots <= 0) {
                alert(`最多只能上传${maxImages}张图片！`);
                return;
            }
            
            const filesToUpload = Array.from(files).slice(0, remainingSlots);
            
            filesToUpload.forEach(file => {
                if (!file.type.match('image/jpeg') && !file.type.match('image/jpg') && !file.type.match('image/png')) {
                    alert('只支持JPG、JPEG、PNG格式的图片！');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    existingImages.push(e.target.result);
                    localStorage.setItem(storageKey, JSON.stringify(existingImages));
                    
                    // 重新加载图片
                    loadImagesToTabs();
                    showSuccessToast();
                };
                reader.readAsDataURL(file);
            });
        }
        
        // 处理戳戳我图片上传
        function handlePokeUpload(file) {
            if (!file) return;
            
            if (!file.type.match('image/jpeg') && !file.type.match('image/jpg') && !file.type.match('image/png')) {
                alert('只支持JPG、JPEG、PNG格式的图片！');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const imageData = e.target.result;
                localStorage.setItem('pokeImages', JSON.stringify([imageData]));
                loadImagesToTabs();
                showSuccessToast();
            };
            reader.readAsDataURL(file);
        }
        
        // 加载背景
        function loadBackground() {
            const background = localStorage.getItem('background');
            if (background) {
                document.body.style.backgroundImage = `url(${background})`;
            } else {
                document.body.style.backgroundImage = '';
            }
        }
        
        // 加载LOGO
        function loadLogo() {
            const logoContainer = document.getElementById('logoDisplay');
            const logo = localStorage.getItem('logo');
            
            if (logo) {
                logoContainer.innerHTML = `<img src="${logo}" alt="LOGO" class="logo viewable-image">`;
            } else {
                logoContainer.innerHTML = '<div class="logo-placeholder">LOGO</div>';
            }
        }
        
        // 加载图片到各个标签页
        function loadImagesToTabs() {
            // 加载网点清单图片
            const branchImages = JSON.parse(localStorage.getItem('branchImages')) || [];
            const branchContainer = document.getElementById('branchImagesContainer');
            
            if (branchImages.length > 0) {
                branchContainer.innerHTML = '';
                branchImages.forEach((img, index) => {
                    const imgElement = document.createElement('div');
                    imgElement.className = 'image-item';
                    imgElement.innerHTML = `
                        <img src="${img}" alt="网点清单图片 ${index + 1}" class="viewable-image">
                        <div class="file-actions" style="padding: 10px;">
                            <button class="btn-small btn-danger" onclick="deleteImage('branchImages', ${index})">
                                <i class="fas fa-trash"></i> 删除
                            </button>
                        </div>
                    `;
                    branchContainer.appendChild(imgElement);
                });
            } else {
                branchContainer.innerHTML = '<div class="no-data">暂无网点清单图片，请在设置页面上传</div>';
            }
            
            // 加载资费清单图片
            const feeImages = JSON.parse(localStorage.getItem('feeImages')) || [];
            const feeContainer = document.getElementById('feeImagesContainer');
            
            if (feeImages.length > 0) {
                feeContainer.innerHTML = '';
                feeImages.forEach((img, index) => {
                    const imgElement = document.createElement('div');
                    imgElement.className = 'image-item';
                    imgElement.innerHTML = `
                        <img src="${img}" alt="资费清单图片 ${index + 1}" class="viewable-image">
                        <div class="file-actions" style="padding: 10px;">
                            <button class="btn-small btn-danger" onclick="deleteImage('feeImages', ${index})">
                                <i class="fas fa-trash"></i> 删除
                            </button>
                        </div>
                    `;
                    feeContainer.appendChild(imgElement);
                });
            } else {
                feeContainer.innerHTML = '<div class="no-data">暂无资费清单图片，请在设置页面上传</div>';
            }
            
            // 加载戳戳我图片
            const pokeImages = JSON.parse(localStorage.getItem('pokeImages')) || [];
            const pokeContainer = document.getElementById('pokeImagesContainer');
            
            if (pokeImages.length > 0) {
                pokeContainer.innerHTML = '';
                pokeImages.forEach((img, index) => {
                    const imgElement = document.createElement('div');
                    imgElement.className = 'image-item';
                    imgElement.innerHTML = `
                        <img src="${img}" alt="戳戳我图片" class="viewable-image">
                        <div class="file-actions" style="padding: 10px;">
                            <button class="btn-small btn-danger" onclick="deleteImage('pokeImages', ${index})">
                                <i class="fas fa-trash"></i> 删除
                            </button>
                        </div>
                    `;
                    pokeContainer.appendChild(imgElement);
                });
            } else {
                pokeContainer.innerHTML = '<div class="no-data">暂无戳戳我图片，请在设置页面上传</div>';
            }
        }
        
        // 加载在柜数据
        function loadCabinetData() {
            const cabinetData = JSON.parse(localStorage.getItem('cabinetData')) || [];
            const cabinetDataBody = document.getElementById('cabinetDataBody');
            const cabinetDataNoData = document.getElementById('cabinetDataNoData');
            const cabinetInfoBody = document.getElementById('cabinetInfoBody');
            const cabinetInfoNoData = document.getElementById('cabinetInfoNoData');
            
            // 更新在柜数据访问表格
            if (cabinetData.length > 0) {
                cabinetDataBody.innerHTML = '';
                cabinetData.forEach(item => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${item.area}</td>
                        <td>${item.district}</td>
                        <td>${item.number}</td>
                        <td>${item.type}</td>
                        <td>${item.location}</td>
                        <td><span class="${item.status === '已入柜' ? 'status-in' : 'status-out'}">${item.status}</span></td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn-small" onclick="editCabinetData('${item.id}')">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn-small btn-danger" onclick="deleteCabinetData('${item.id}')">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    `;
                    cabinetDataBody.appendChild(row);
                });
                cabinetDataNoData.style.display = 'none';
            } else {
                cabinetDataBody.innerHTML = '';
                cabinetDataNoData.style.display = 'block';
            }
            
            // 更新在柜信息表格
            if (cabinetData.length > 0) {
                cabinetInfoBody.innerHTML = '';
                cabinetData.forEach(item => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${item.area}</td>
                        <td>${item.district}</td>
                        <td>${item.number}</td>
                        <td>${item.type}</td>
                        <td>${item.location}</td>
                        <td><span class="${item.status === '已入柜' ? 'status-in' : 'status-out'}">${item.status}</span></td>
                    `;
                    cabinetInfoBody.appendChild(row);
                });
                cabinetInfoNoData.style.display = 'none';
            } else {
                cabinetInfoBody.innerHTML = '';
                cabinetInfoNoData.style.display = 'block';
            }
        }
        
        // 加载取件人信息
        function loadPickupData() {
            const pickupData = JSON.parse(localStorage.getItem('pickupData')) || [];
            const pickupDataBody = document.getElementById('pickupDataBody');
            const pickupDataNoData = document.getElementById('pickupDataNoData');
            
            if (pickupData.length > 0) {
                pickupDataBody.innerHTML = '';
                pickupData.forEach(item => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${item.pickupNumber}</td>
                        <td>${item.pickupName}</td>
                        <td>${item.pickupPhone}</td>
                        <td>${item.pickupId}</td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn-small btn-danger" onclick="deletePickupData('${item.id}')">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    `;
                    pickupDataBody.appendChild(row);
                });
                pickupDataNoData.style.display = 'none';
            } else {
                pickupDataBody.innerHTML = '';
                pickupDataNoData.style.display = 'block';
            }
        }
        
        // 搜索在柜数据
        function searchCabinetData(searchTerm) {
            const cabinetData = JSON.parse(localStorage.getItem('cabinetData')) || [];
            const cabinetDataBody = document.getElementById('cabinetDataBody');
            const cabinetDataNoData = document.getElementById('cabinetDataNoData');
            
            if (!searchTerm) {
                loadCabinetData();
                return;
            }
            
            const filteredData = cabinetData.filter(item => 
                item.area.toLowerCase().includes(searchTerm.toLowerCase()) ||
                item.district.toLowerCase().includes(searchTerm.toLowerCase()) ||
                item.number.toLowerCase().includes(searchTerm.toLowerCase()) ||
                item.type.toLowerCase().includes(searchTerm.toLowerCase()) ||
                item.location.toLowerCase().includes(searchTerm.toLowerCase()) ||
                item.status.toLowerCase().includes(searchTerm.toLowerCase())
            );
            
            if (filteredData.length > 0) {
                cabinetDataBody.innerHTML = '';
                filteredData.forEach(item => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${item.area}</td>
                        <td>${item.district}</td>
                        <td>${item.number}</td>
                        <td>${item.type}</td>
                        <td>${item.location}</td>
                        <td><span class="${item.status === '已入柜' ? 'status-in' : 'status-out'}">${item.status}</span></td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn-small" onclick="editCabinetData('${item.id}')">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="btn-small btn-danger" onclick="deleteCabinetData('${item.id}')">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    `;
                    cabinetDataBody.appendChild(row);
                });
                cabinetDataNoData.style.display = 'none';
            } else {
                cabinetDataBody.innerHTML = '';
                cabinetDataNoData.style.display = 'block';
            }
        }
        
        // 搜索取件人信息
        function searchPickupData(searchTerm) {
            const pickupData = JSON.parse(localStorage.getItem('pickupData')) || [];
            const pickupDataBody = document.getElementById('pickupDataBody');
            const pickupDataNoData = document.getElementById('pickupDataNoData');
            
            if (!searchTerm) {
                loadPickupData();
                return;
            }
            
            const filteredData = pickupData.filter(item => 
                item.pickupNumber.toLowerCase().includes(searchTerm.toLowerCase()) ||
                item.pickupName.toLowerCase().includes(searchTerm.toLowerCase()) ||
                item.pickupPhone.toLowerCase().includes(searchTerm.toLowerCase()) ||
                item.pickupId.toLowerCase().includes(searchTerm.toLowerCase())
            );
            
            if (filteredData.length > 0) {
                pickupDataBody.innerHTML = '';
                filteredData.forEach(item => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${item.pickupNumber}</td>
                        <td>${item.pickupName}</td>
                        <td>${item.pickupPhone}</td>
                        <td>${item.pickupId}</td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn-small btn-danger" onclick="deletePickupData('${item.id}')">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </td>
                    `;
                    pickupDataBody.appendChild(row);
                });
                pickupDataNoData.style.display = 'none';
            } else {
                pickupDataBody.innerHTML = '';
                pickupDataNoData.style.display = 'block';
            }
        }
        
        // 编辑在柜数据
        function editCabinetData(id) {
            const cabinetData = JSON.parse(localStorage.getItem('cabinetData')) || [];
            const item = cabinetData.find(item => item.id == id);
            
            if (!item) return;
            
            const newStatus = prompt('请输入新的状态（已入柜/已出柜）:', item.status);
            if (newStatus && (newStatus === '已入柜' || newStatus === '已出柜')) {
                item.status = newStatus;
                localStorage.setItem('cabinetData', JSON.stringify(cabinetData));
                loadCabinetData();
                showSuccessToast();
            } else if (newStatus) {
                alert('状态只能为"已入柜"或"已出柜"！');
            }
        }
        
        // 删除在柜数据
        function deleteCabinetData(id) {
            if (confirm('确定要删除这条数据吗？')) {
                let cabinetData = JSON.parse(localStorage.getItem('cabinetData')) || [];
                cabinetData = cabinetData.filter(item => item.id != id);
                localStorage.setItem('cabinetData', JSON.stringify(cabinetData));
                loadCabinetData();
                showSuccessToast();
            }
        }
        
        // 删除取件人信息
        function deletePickupData(id) {
            if (confirm('确定要删除这条取件人信息吗？')) {
                let pickupData = JSON.parse(localStorage.getItem('pickupData')) || [];
                pickupData = pickupData.filter(item => item.id != id);
                localStorage.setItem('pickupData', JSON.stringify(pickupData));
                loadPickupData();
                showSuccessToast();
            }
        }
        
        // 删除图片
        function deleteImage(storageKey, index) {
            if (confirm('确定要删除这张图片吗？')) {
                let images = JSON.parse(localStorage.getItem(storageKey)) || [];
                images.splice(index, 1);
                localStorage.setItem(storageKey, JSON.stringify(images));
                loadImagesToTabs();
                showSuccessToast();
            }
        }
        
        // 显示成功提示
        function showSuccessToast() {
            const toast = document.getElementById('successToast');
            toast.style.display = 'block';
            setTimeout(() => {
                toast.style.display = 'none';
            }, 2000);
        }
    </script>
</body>
</html>
