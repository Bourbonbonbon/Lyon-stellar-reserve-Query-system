<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>里昂星储—查询系统</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        :root {
            --primary-color: #1a4b8c;
            --secondary-color: #2d6bc2;
            --accent-color: #f0b400;
            --light-color: #f5f7fa;
            --dark-color: #2c3e50;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --border-radius: 8px;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        
        body {
            background-color: #f0f2f5;
            background-image: url('');
            background-size: cover;
            background-attachment: fixed;
            background-position: center;
            color: #333;
            min-height: 100vh;
            transition: background-image 0.5s ease;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background-color: rgba(255, 255, 255, 0.95);
            padding: 15px 30px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo {
            height: 60px;
            width: 60px;
            object-fit: contain;
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        .logo:hover {
            transform: scale(1.05);
        }
        
        .logo-placeholder {
            height: 60px;
            width: 60px;
            background-color: var(--primary-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
            font-weight: bold;
        }
        
        h1 {
            color: var(--primary-color);
            font-size: 28px;
        }
        
        .tabs {
            display: flex;
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .tab {
            padding: 18px 30px;
            cursor: pointer;
            font-weight: 600;
            color: var(--dark-color);
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            flex-grow: 1;
            text-align: center;
        }
        
        .tab:hover {
            background-color: rgba(26, 75, 140, 0.05);
            color: var(--primary-color);
        }
        
        .tab.active {
            color: var(--primary-color);
            border-bottom: 3px solid var(--accent-color);
            background-color: rgba(26, 75, 140, 0.08);
        }
        
        .tab-content {
            display: none;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 30px;
            min-height: 500px;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .section-title {
            font-size: 22px;
            color: var(--primary-color);
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .btn {
            padding: 10px 20px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn:hover {
            background-color: var(--secondary-color);
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
        }
        
        .btn-success {
            background-color: var(--success-color);
        }
        
        .btn-danger {
            background-color: var(--danger-color);
        }
        
        .btn-accent {
            background-color: var(--accent-color);
            color: #333;
        }
        
        .images-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .image-item {
            background-color: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
        }
        
        .image-item:hover {
            transform: translateY(-5px);
        }
        
        .image-item img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            cursor: pointer;
        }
        
        .image-info {
            padding: 15px;
        }
        
        .image-title {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--dark-color);
        }
        
        .image-date {
            font-size: 14px;
            color: #777;
        }
        
        .image-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .no-data {
            text-align: center;
            padding: 60px 20px;
            color: #888;
            font-size: 18px;
            grid-column: 1 / -1;
        }
        
        .no-data i {
            font-size: 48px;
            margin-bottom: 15px;
            color: #ccc;
        }
        
        /* 弹窗样式 */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .modal {
            background-color: white;
            border-radius: var(--border-radius);
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            padding: 30px;
            position: relative;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        
        .modal-close {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #888;
        }
        
        .modal-title {
            font-size: 24px;
            color: var(--primary-color);
            margin-bottom: 25px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark-color);
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-size: 16px;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--primary-color);
        }
        
        .image-preview {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 10px;
        }
        
        .preview-item {
            width: 120px;
            height: 120px;
            position: relative;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .preview-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .preview-item .remove-img {
            position: absolute;
            top: 5px;
            right: 5px;
            background-color: rgba(220, 53, 69, 0.8);
            color: white;
            border: none;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* 在柜信息表格样式 */
        .table-container {
            overflow-x: auto;
            margin-bottom: 40px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background-color: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
        }
        
        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        th {
            background-color: var(--primary-color);
            color: white;
            font-weight: 600;
        }
        
        tr:hover {
            background-color: #f9f9f9;
        }
        
        .status-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }
        
        .status-in {
            background-color: rgba(40, 167, 69, 0.1);
            color: var(--success-color);
        }
        
        .status-out {
            background-color: rgba(220, 53, 69, 0.1);
            color: var(--danger-color);
        }
        
        /* 图片查看模态框 */
        .image-viewer-modal .modal {
            max-width: 90%;
            max-height: 90vh;
            background-color: transparent;
            box-shadow: none;
        }
        
        .image-viewer-modal img {
            max-width: 100%;
            max-height: 80vh;
            object-fit: contain;
        }
        
        /* 设置页面样式 */
        .settings-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        .setting-item {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow);
        }
        
        .preview-area {
            margin-top: 20px;
            padding: 20px;
            border: 2px dashed #ddd;
            border-radius: var(--border-radius);
            text-align: center;
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .preview-area img {
            max-width: 100%;
            max-height: 300px;
            object-fit: contain;
        }
        
        /* 密码输入框 */
        .password-input {
            position: relative;
        }
        
        .password-input input {
            padding-right: 40px;
        }
        
        .toggle-password {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: #777;
            cursor: pointer;
        }
        
        /* 响应式设计 */
        @media (max-width: 992px) {
            .settings-container {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .tab {
                padding: 15px 10px;
                font-size: 14px;
            }
            
            .tab-content {
                padding: 20px 15px;
            }
            
            .images-container {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
            
            .modal {
                padding: 20px 15px;
            }
        }
        
        @media (max-width: 576px) {
            .images-container {
                grid-template-columns: 1fr;
            }
        }
        
        /* 戳戳我特殊样式 */
        .poke-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 400px;
        }
        
        .poke-image {
            max-width: 100%;
            max-height: 400px;
            border-radius: var(--border-radius);
            cursor: pointer;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
            transition: transform 0.3s;
        }
        
        .poke-image:hover {
            transform: scale(1.02);
        }
        
        /* 加载动画 */
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo-container">
                <div id="logoDisplay" class="logo-placeholder">LOGO</div>
                <h1>里昂星储—查询系统</h1>
            </div>
            <div class="system-info">
                <p>当前时间: <span id="currentTime"></span></p>
            </div>
        </header>
        
        <div class="tabs">
            <div class="tab active" data-tab="announcement">公告</div>
            <div class="tab" data-tab="network">网点清单</div>
            <div class="tab" data-tab="pricing">资费清单</div>
            <div class="tab" data-tab="cabinet">在柜信息</div>
            <div class="tab" data-tab="settings">设置</div>
            <div class="tab" data-tab="poke">戳戳我</div>
        </div>
        
        <!-- 公告标签页 -->
        <div id="announcement" class="tab-content active">
            <div class="section-title">
                <span>公告信息</span>
                <button class="btn" id="addAnnouncementBtn">
                    <i class="fas fa-plus-circle"></i> 上传公告
                </button>
            </div>
            
            <div id="announcementContainer" class="images-container">
                <!-- 公告图片会动态加载到这里 -->
                <div class="no-data">
                    <i class="fas fa-bullhorn"></i>
                    <p>暂无公告信息，点击"上传公告"添加第一条公告</p>
                </div>
            </div>
        </div>
        
        <!-- 网点清单标签页 -->
        <div id="network" class="tab-content">
            <div class="section-title">
                <span>网点清单</span>
                <button class="btn" id="addNetworkBtn">
                    <i class="fas fa-plus-circle"></i> 上传网点
                </button>
            </div>
            
            <div id="networkContainer" class="images-container">
                <!-- 网点图片会动态加载到这里 -->
                <div class="no-data">
                    <i class="fas fa-map-marker-alt"></i>
                    <p>暂无网点信息，点击"上传网点"添加第一条网点信息</p>
                </div>
            </div>
        </div>
        
        <!-- 资费清单标签页 -->
        <div id="pricing" class="tab-content">
            <div class="section-title">
                <span>资费清单</span>
                <button class="btn" id="addPricingBtn">
                    <i class="fas fa-plus-circle"></i> 上传资费
                </button>
            </div>
            
            <div id="pricingContainer" class="images-container">
                <!-- 资费图片会动态加载到这里 -->
                <div class="no-data">
                    <i class="fas fa-money-bill-wave"></i>
                    <p>暂无资费信息，点击"上传资费"添加第一条资费信息</p>
                </div>
            </div>
        </div>
        
        <!-- 在柜信息标签页 -->
        <div id="cabinet" class="tab-content">
            <div class="section-title">
                <span>在柜包裹信息</span>
                <button class="btn" id="addCabinetBtn">
                    <i class="fas fa-plus-circle"></i> 添加入柜信息
                </button>
            </div>
            
            <div class="table-container">
                <table id="cabinetTable">
                    <thead>
                        <tr>
                            <th>区域</th>
                            <th>大区</th>
                            <th>编号</th>
                            <th>类型</th>
                            <th>存放位置</th>
                            <th>状态</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- 在柜信息会动态加载到这里 -->
                        <tr>
                            <td colspan="7" style="text-align: center; padding: 40px;">
                                <i class="fas fa-box-open" style="font-size: 48px; color: #ccc; margin-bottom: 15px;"></i>
                                <p>暂无在柜信息，点击"添加入柜信息"添加第一条记录</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <div class="section-title" style="margin-top: 40px;">
                <span>取件人信息</span>
                <button class="btn" id="addRecipientBtn">
                    <i class="fas fa-plus-circle"></i> 添加取件人
                </button>
            </div>
            
            <div class="table-container">
                <table id="recipientTable">
                    <thead>
                        <tr>
                            <th>待取件编号</th>
                            <th>取件人姓名</th>
                            <th>联系电话</th>
                            <th>身份证明后四位</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- 取件人信息会动态加载到这里 -->
                        <tr>
                            <td colspan="5" style="text-align: center; padding: 40px;">
                                <i class="fas fa-users" style="font-size: 48px; color: #ccc; margin-bottom: 15px;"></i>
                                <p>暂无取件人信息，点击"添加取件人"添加第一条记录</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- 设置标签页 -->
        <div id="settings" class="tab-content">
            <div class="section-title">
                <span>系统设置</span>
            </div>
            
            <div class="settings-container">
                <div class="setting-item">
                    <h3>LOGO设置</h3>
                    <p>支持上传的格式为JPG、JPEG、PNG，建议尺寸为75px*75px</p>
                    <div id="logoPreview" class="preview-area">
                        <p>当前未设置LOGO</p>
                    </div>
                    <div style="margin-top: 20px; display: flex; gap: 10px;">
                        <button class="btn" id="uploadLogoBtn">
                            <i class="fas fa-upload"></i> 上传LOGO
                        </button>
                        <button class="btn btn-danger" id="removeLogoBtn" disabled>
                            <i class="fas fa-trash"></i> 删除LOGO
                        </button>
                    </div>
                </div>
                
                <div class="setting-item">
                    <h3>背景设置</h3>
                    <p>支持上传的格式为JPG、JPEG、PNG，将覆盖整个网页背景</p>
                    <div id="backgroundPreview" class="preview-area">
                        <p>当前使用默认背景</p>
                    </div>
                    <div style="margin-top: 20px; display: flex; gap: 10px;">
                        <button class="btn" id="uploadBgBtn">
                            <i class="fas fa-upload"></i> 上传背景
                        </button>
                        <button class="btn btn-danger" id="removeBgBtn" disabled>
                            <i class="fas fa-trash"></i> 删除背景
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 戳戳我标签页 -->
        <div id="poke" class="tab-content">
            <div class="section-title">
                <span>戳戳我</span>
                <button class="btn" id="addPokeBtn">
                    <i class="fas fa-plus-circle"></i> 上传图片
                </button>
            </div>
            
            <div class="poke-container">
                <div id="pokeContent" class="no-data">
                    <i class="fas fa-smile-wink"></i>
                    <p>暂无内容，点击"上传图片"添加图片</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 密码验证弹窗 -->
    <div id="passwordModal" class="modal-overlay">
        <div class="modal">
            <button class="modal-close" id="closePasswordModal">&times;</button>
            <h3 class="modal-title">密码验证</h3>
            <div class="form-group">
                <label for="passwordInput">请输入管理密码</label>
                <div class="password-input">
                    <input type="password" id="passwordInput" placeholder="请输入密码">
                    <button type="button" class="toggle-password" id="togglePassword">
                        <i class="fas fa-eye"></i>
                    </button>
                </div>
                <p id="passwordError" style="color: #dc3545; margin-top: 10px; display: none;">密码错误，请重试</p>
            </div>
            <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 20px;">
                <button class="btn" id="cancelPasswordBtn">取消</button>
                <button class="btn btn-accent" id="submitPasswordBtn">确认</button>
            </div>
        </div>
    </div>
    
    <!-- 公告上传弹窗 -->
    <div id="announcementModal" class="modal-overlay">
        <div class="modal">
            <button class="modal-close" id="closeAnnouncementModal">&times;</button>
            <h3 class="modal-title">上传公告</h3>
            <form id="announcementForm">
                <div class="form-group">
                    <label for="announcementImages">图片上传（最多5张）</label>
                    <input type="file" id="announcementImages" accept=".jpg,.jpeg,.png" multiple>
                    <div id="announcementPreview" class="image-preview"></div>
                </div>
                
                <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 30px;">
                    <button type="button" class="btn" id="cancelAnnouncementBtn">取消</button>
                    <button type="submit" class="btn btn-accent">提交</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- 网点上传弹窗 -->
    <div id="networkModal" class="modal-overlay">
        <div class="modal">
            <button class="modal-close" id="closeNetworkModal">&times;</button>
            <h3 class="modal-title">上传网点清单</h3>
            <form id="networkForm">
                <div class="form-group">
                    <label for="networkImages">图片上传（最多5张）</label>
                    <input type="file" id="networkImages" accept=".jpg,.jpeg,.png" multiple>
                    <div id="networkPreview" class="image-preview"></div>
                </div>
                
                <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 30px;">
                    <button type="button" class="btn" id="cancelNetworkBtn">取消</button>
                    <button type="submit" class="btn btn-accent">提交</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- 资费上传弹窗 -->
    <div id="pricingModal" class="modal-overlay">
        <div class="modal">
            <button class="modal-close" id="closePricingModal">&times;</button>
            <h3 class="modal-title">上传资费清单</h3>
            <form id="pricingForm">
                <div class="form-group">
                    <label for="pricingImages">图片上传（最多5张）</label>
                    <input type="file" id="pricingImages" accept=".jpg,.jpeg,.png" multiple>
                    <div id="pricingPreview" class="image-preview"></div>
                </div>
                
                <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 30px;">
                    <button type="button" class="btn" id="cancelPricingBtn">取消</button>
                    <button type="submit" class="btn btn-accent">提交</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- 在柜信息弹窗 -->
    <div id="cabinetModal" class="modal-overlay">
        <div class="modal">
            <button class="modal-close" id="closeCabinetModal">&times;</button>
            <h3 class="modal-title" id="cabinetModalTitle">添加入柜信息</h3>
            <form id="cabinetForm">
                <div class="form-group">
                    <label for="cabinetArea">区域</label>
                    <input type="text" id="cabinetArea" placeholder="请输入区域" required>
                </div>
                
                <div class="form-group">
                    <label for="cabinetDistrict">大区</label>
                    <input type="text" id="cabinetDistrict" placeholder="请输入大区" required>
                </div>
                
                <div class="form-group">
                    <label for="cabinetNumber">编号</label>
                    <input type="text" id="cabinetNumber" placeholder="请输入编号" required>
                </div>
                
                <div class="form-group">
                    <label for="cabinetType">类型</label>
                    <select id="cabinetType" required>
                        <option value="">请选择类型</option>
                        <option value="平信">平信</option>
                        <option value="明信片">明信片</option>
                        <option value="包裹">包裹</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="cabinetLocation">存放位置（柜号）</label>
                    <input type="text" id="cabinetLocation" placeholder="请输入柜号" required>
                </div>
                
                <div class="form-group">
                    <label for="cabinetStatus">状态</label>
                    <select id="cabinetStatus" required>
                        <option value="">请选择状态</option>
                        <option value="已入柜">已入柜</option>
                        <option value="已出柜">已出柜</option>
                    </select>
                </div>
                
                <input type="hidden" id="cabinetId">
                
                <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 30px;">
                    <button type="button" class="btn" id="cancelCabinetBtn">取消</button>
                    <button type="submit" class="btn btn-accent">提交</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- 取件人信息弹窗 -->
    <div id="recipientModal" class="modal-overlay">
        <div class="modal">
            <button class="modal-close" id="closeRecipientModal">&times;</button>
            <h3 class="modal-title" id="recipientModalTitle">添加取件人信息</h3>
            <form id="recipientForm">
                <div class="form-group">
                    <label for="recipientNumber">待取件的编号</label>
                    <input type="text" id="recipientNumber" placeholder="请输入待取件的编号" required>
                </div>
                
                <div class="form-group">
                    <label for="recipientName">取件人姓名</label>
                    <input type="text" id="recipientName" placeholder="请输入取件人姓名" required>
                </div>
                
                <div class="form-group">
                    <label for="recipientPhone">联系电话</label>
                    <input type="tel" id="recipientPhone" placeholder="请输入联系电话" required>
                </div>
                
                <div class="form-group">
                    <label for="recipientId">身份证明号码后四位</label>
                    <input type="text" id="recipientId" placeholder="请输入身份证明号码后四位" maxlength="4" required>
                </div>
                
                <input type="hidden" id="recipientDataId">
                
                <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 30px;">
                    <button type="button" class="btn" id="cancelRecipientBtn">取消</button>
                    <button type="submit" class="btn btn-accent">提交</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- 戳戳我上传弹窗 -->
    <div id="pokeModal" class="modal-overlay">
        <div class="modal">
            <button class="modal-close" id="closePokeModal">&times;</button>
            <h3 class="modal-title">上传图片</h3>
            <form id="pokeForm">
                <div class="form-group">
                    <label for="pokeImage">图片上传</label>
                    <input type="file" id="pokeImage" accept=".jpg,.jpeg,.png">
                    <div id="pokePreview" class="image-preview"></div>
                </div>
                
                <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 30px;">
                    <button type="button" class="btn" id="cancelPokeBtn">取消</button>
                    <button type="submit" class="btn btn-accent">提交</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- LOGO上传弹窗 -->
    <div id="logoModal" class="modal-overlay">
        <div class="modal">
            <button class="modal-close" id="closeLogoModal">&times;</button>
            <h3 class="modal-title">上传LOGO</h3>
            <form id="logoForm">
                <div class="form-group">
                    <label for="logoImage">LOGO上传（支持JPG、JPEG、PNG格式）</label>
                    <input type="file" id="logoImage" accept=".jpg,.jpeg,.png">
                    <div id="logoUploadPreview" class="image-preview"></div>
                </div>
                
                <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 30px;">
                    <button type="button" class="btn" id="cancelLogoBtn">取消</button>
                    <button type="submit" class="btn btn-accent">提交</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- 背景上传弹窗 -->
    <div id="backgroundModal" class="modal-overlay">
        <div class="modal">
            <button class="modal-close" id="closeBackgroundModal">&times;</button>
            <h3 class="modal-title">上传背景图片</h3>
            <form id="backgroundForm">
                <div class="form-group">
                    <label for="backgroundImage">背景图片上传（支持JPG、JPEG、PNG格式）</label>
                    <input type="file" id="backgroundImage" accept=".jpg,.jpeg,.png">
                    <div id="backgroundUploadPreview" class="image-preview"></div>
                </div>
                
                <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 30px;">
                    <button type="button" class="btn" id="cancelBackgroundBtn">取消</button>
                    <button type="submit" class="btn btn-accent">提交</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- 图片查看弹窗 -->
    <div id="imageViewerModal" class="modal-overlay image-viewer-modal">
        <div class="modal">
            <button class="modal-close" id="closeImageViewerModal">&times;</button>
            <img id="viewedImage" src="" alt="查看图片">
        </div>
    </div>
    
    <script>
        // 全局变量
        const DEFAULT_PASSWORD = "740302";
        let currentTab = "announcement";
        let currentPasswordAction = null;
        let editingItem = null;
        
        // 数据存储
        let systemData = {
            announcements: [],
            networkPoints: [],
            pricing: [],
            cabinetItems: [],
            recipients: [],
            pokeImage: null,
            logo: null,
            background: null
        };
        
        // DOM加载完成后初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 从localStorage加载数据
            loadData();
            
            // 初始化时间显示
            updateTime();
            setInterval(updateTime, 1000);
            
            // 标签切换功能
            initTabs();
            
            // 初始化所有按钮事件
            initButtons();
            
            // 初始化表单事件
            initForms();
            
            // 加载各标签页数据
            loadTabData();
            
            // 设置LOGO和背景
            applyLogoAndBackground();
        });
        
        // 更新当前时间
        function updateTime() {
            const now = new Date();
            const dateStr = now.toLocaleDateString('zh-CN', { 
                year: 'numeric', 
                month: '2-digit', 
                day: '2-digit' 
            });
            const timeStr = now.toLocaleTimeString('zh-CN', { 
                hour12: false,
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            document.getElementById('currentTime').textContent = `${dateStr} ${timeStr}`;
        }
        
        // 标签切换功能
        function initTabs() {
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    switchTab(tabId);
                    
                    // 保存当前标签到localStorage
                    localStorage.setItem('currentTab', tabId);
                });
            });
            
            // 恢复上次的标签页
            const savedTab = localStorage.getItem('currentTab');
            if (savedTab) {
                switchTab(savedTab);
            }
        }
        
        // 切换标签页
        function switchTab(tabId) {
            // 更新标签样式
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`.tab[data-tab="${tabId}"]`).classList.add('active');
            
            // 更新内容区域
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(tabId).classList.add('active');
            
            currentTab = tabId;
        }
        
        // 初始化按钮事件
        function initButtons() {
            // 公告按钮
            document.getElementById('addAnnouncementBtn').addEventListener('click', function() {
                showPasswordModal('announcement');
            });
            
            // 网点按钮
            document.getElementById('addNetworkBtn').addEventListener('click', function() {
                showPasswordModal('network');
            });
            
            // 资费按钮
            document.getElementById('addPricingBtn').addEventListener('click', function() {
                showPasswordModal('pricing');
            });
            
            // 在柜信息按钮
            document.getElementById('addCabinetBtn').addEventListener('click', function() {
                openCabinetModal();
            });
            
            // 取件人按钮
            document.getElementById('addRecipientBtn').addEventListener('click', function() {
                openRecipientModal();
            });
            
            // 戳戳我按钮
            document.getElementById('addPokeBtn').addEventListener('click', function() {
                showPasswordModal('poke');
            });
            
            // 设置按钮
            document.getElementById('uploadLogoBtn').addEventListener('click', function() {
                showPasswordModal('logo');
            });
            
            document.getElementById('removeLogoBtn').addEventListener('click', function() {
                if (confirm('确定要删除LOGO吗？')) {
                    removeLogo();
                }
            });
            
            document.getElementById('uploadBgBtn').addEventListener('click', function() {
                showPasswordModal('background');
            });
            
            document.getElementById('removeBgBtn').addEventListener('click', function() {
                if (confirm('确定要删除背景图片吗？')) {
                    removeBackground();
                }
            });
            
            // 密码弹窗按钮
            document.getElementById('closePasswordModal').addEventListener('click', function() {
                closePasswordModal();
            });
            
            document.getElementById('cancelPasswordBtn').addEventListener('click', function() {
                closePasswordModal();
            });
            
            document.getElementById('submitPasswordBtn').addEventListener('click', function() {
                checkPassword();
            });
            
            document.getElementById('togglePassword').addEventListener('click', function() {
                const passwordInput = document.getElementById('passwordInput');
                const icon = this.querySelector('i');
                if (passwordInput.type === 'password') {
                    passwordInput.type = 'text';
                    icon.className = 'fas fa-eye-slash';
                } else {
                    passwordInput.type = 'password';
                    icon.className = 'fas fa-eye';
                }
            });
            
            // 其他弹窗关闭按钮
            const closeButtons = [
                'closeAnnouncementModal', 'closeNetworkModal', 'closePricingModal',
                'closeCabinetModal', 'closeRecipientModal', 'closePokeModal',
                'closeLogoModal', 'closeBackgroundModal', 'closeImageViewerModal'
            ];
            
            closeButtons.forEach(id => {
                document.getElementById(id).addEventListener('click', function() {
                    document.getElementById(id.replace('close', '').replace('Modal', '') + 'Modal').style.display = 'none';
                });
            });
            
            // 取消按钮
            const cancelButtons = [
                { id: 'cancelAnnouncementBtn', modal: 'announcementModal' },
                { id: 'cancelNetworkBtn', modal: 'networkModal' },
                { id: 'cancelPricingBtn', modal: 'pricingModal' },
                { id: 'cancelCabinetBtn', modal: 'cabinetModal' },
                { id: 'cancelRecipientBtn', modal: 'recipientModal' },
                { id: 'cancelPokeBtn', modal: 'pokeModal' },
                { id: 'cancelLogoBtn', modal: 'logoModal' },
                { id: 'cancelBackgroundBtn', modal: 'backgroundModal' }
            ];
            
            cancelButtons.forEach(btn => {
                document.getElementById(btn.id).addEventListener('click', function() {
                    document.getElementById(btn.modal).style.display = 'none';
                });
            });
        }
        
        // 初始化表单事件
        function initForms() {
            // 公告表单
            document.getElementById('announcementForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveAnnouncement();
            });
            
            // 网点表单
            document.getElementById('networkForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveNetwork();
            });
            
            // 资费表单
            document.getElementById('pricingForm').addEventListener('submit', function(e) {
                e.preventDefault();
                savePricing();
            });
            
            // 在柜信息表单
            document.getElementById('cabinetForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveCabinetItem();
            });
            
            // 取件人表单
            document.getElementById('recipientForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveRecipient();
            });
            
            // 戳戳我表单
            document.getElementById('pokeForm').addEventListener('submit', function(e) {
                e.preventDefault();
                savePoke();
            });
            
            // LOGO表单
            document.getElementById('logoForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveLogo();
            });
            
            // 背景表单
            document.getElementById('backgroundForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveBackground();
            });
            
            // 文件预览功能
            initFilePreviews();
        }
        
        // 初始化文件预览
        function initFilePreviews() {
            const fileInputs = [
                { id: 'announcementImages', previewId: 'announcementPreview', max: 5 },
                { id: 'networkImages', previewId: 'networkPreview', max: 5 },
                { id: 'pricingImages', previewId: 'pricingPreview', max: 5 },
                { id: 'pokeImage', previewId: 'pokePreview', max: 1 },
                { id: 'logoImage', previewId: 'logoUploadPreview', max: 1 },
                { id: 'backgroundImage', previewId: 'backgroundUploadPreview', max: 1 }
            ];
            
            fileInputs.forEach(input => {
                const fileInput = document.getElementById(input.id);
                if (fileInput) {
                    fileInput.addEventListener('change', function() {
                        const previewContainer = document.getElementById(input.previewId);
                        previewContainer.innerHTML = '';
                        
                        const files = Array.from(this.files).slice(0, input.max);
                        
                        files.forEach((file, index) => {
                            if (!file.type.match('image.*')) {
                                alert('请上传图片文件！');
                                return;
                            }
                            
                            const reader = new FileReader();
                            reader.onload = function(e) {
                                const img = document.createElement('img');
                                img.src = e.target.result;
                                img.style.maxWidth = '100%';
                                
                                const previewItem = document.createElement('div');
                                previewItem.className = 'preview-item';
                                previewItem.innerHTML = `
                                    <img src="${e.target.result}" alt="预览">
                                    <button type="button" class="remove-img" data-index="${index}">&times;</button>
                                `;
                                
                                previewContainer.appendChild(previewItem);
                                
                                // 添加删除按钮事件
                                previewItem.querySelector('.remove-img').addEventListener('click', function() {
                                    previewItem.remove();
                                    // 这里可以添加从文件列表中移除的逻辑
                                });
                            };
                            reader.readAsDataURL(file);
                        });
                    });
                }
            });
        }
        
        // 显示密码弹窗
        function showPasswordModal(action) {
            currentPasswordAction = action;
            document.getElementById('passwordInput').value = '';
            document.getElementById('passwordError').style.display = 'none';
            document.getElementById('passwordModal').style.display = 'flex';
        }
        
        // 关闭密码弹窗
        function closePasswordModal() {
            document.getElementById('passwordModal').style.display = 'none';
            currentPasswordAction = null;
        }
        
        // 检查密码
        function checkPassword() {
            const password = document.getElementById('passwordInput').value;
            const errorElement = document.getElementById('passwordError');
            
            if (password === DEFAULT_PASSWORD) {
                closePasswordModal();
                // 根据操作类型打开对应的弹窗
                switch(currentPasswordAction) {
                    case 'announcement':
                        openAnnouncementModal();
                        break;
                    case 'network':
                        openNetworkModal();
                        break;
                    case 'pricing':
                        openPricingModal();
                        break;
                    case 'poke':
                        openPokeModal();
                        break;
                    case 'logo':
                        openLogoModal();
                        break;
                    case 'background':
                        openBackgroundModal();
                        break;
                }
            } else {
                errorElement.style.display = 'block';
            }
        }
        
        // 打开公告弹窗
        function openAnnouncementModal(editIndex = null) {
            editingItem = editIndex;
            const modal = document.getElementById('announcementModal');
            const form = document.getElementById('announcementForm');
            const preview = document.getElementById('announcementPreview');
            
            // 重置表单
            form.reset();
            preview.innerHTML = '';
            document.getElementById('announcementImages').value = '';
            
            // 如果是编辑模式，加载数据
            if (editIndex !== null && systemData.announcements[editIndex]) {
                const item = systemData.announcements[editIndex];
                // 对于图片数据，我们无法通过文件输入预加载，所以只是显示现有图片
                item.images.forEach((image, index) => {
                    const previewItem = document.createElement('div');
                    previewItem.className = 'preview-item';
                    previewItem.innerHTML = `
                        <img src="${image}" alt="公告图片 ${index + 1}">
                        <button type="button" class="remove-img" data-index="${index}">&times;</button>
                    `;
                    preview.appendChild(previewItem);
                });
            }
            
            modal.style.display = 'flex';
        }
        
        // 保存公告
        function saveAnnouncement() {
            const imagePreviews = document.getElementById('announcementPreview').querySelectorAll('img');
            if (imagePreviews.length === 0) {
                alert('请至少上传一张图片！');
                return;
            }
            
            // 获取图片数据
            const images = [];
            imagePreviews.forEach(img => {
                images.push(img.src);
            });
            
            // 生成当前时间
            const now = new Date();
            const uploadDate = `${now.getFullYear()}年${(now.getMonth() + 1).toString().padStart(2, '0')}月${now.getDate().toString().padStart(2, '0')}日 ${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
            
            if (editingItem !== null) {
                // 更新现有公告
                systemData.announcements[editingItem] = {
                    images: images,
                    date: uploadDate
                };
            } else {
                // 添加新公告
                systemData.announcements.push({
                    images: images,
                    date: uploadDate
                });
            }
            
            saveData();
            loadTabData();
            document.getElementById('announcementModal').style.display = 'none';
            editingItem = null;
            alert('公告保存成功！');
        }
        
        // 打开网点弹窗
        function openNetworkModal(editIndex = null) {
            editingItem = editIndex;
            const modal = document.getElementById('networkModal');
            const form = document.getElementById('networkForm');
            const preview = document.getElementById('networkPreview');
            
            // 重置表单
            form.reset();
            preview.innerHTML = '';
            document.getElementById('networkImages').value = '';
            
            // 如果是编辑模式，加载数据
            if (editIndex !== null && systemData.networkPoints[editIndex]) {
                const item = systemData.networkPoints[editIndex];
                item.images.forEach((image, index) => {
                    const previewItem = document.createElement('div');
                    previewItem.className = 'preview-item';
                    previewItem.innerHTML = `
                        <img src="${image}" alt="网点图片 ${index + 1}">
                        <button type="button" class="remove-img" data-index="${index}">&times;</button>
                    `;
                    preview.appendChild(previewItem);
                });
            }
            
            modal.style.display = 'flex';
        }
        
        // 保存网点
        function saveNetwork() {
            const imagePreviews = document.getElementById('networkPreview').querySelectorAll('img');
            if (imagePreviews.length === 0) {
                alert('请至少上传一张图片！');
                return;
            }
            
            // 获取图片数据
            const images = [];
            imagePreviews.forEach(img => {
                images.push(img.src);
            });
            
            // 生成当前时间
            const now = new Date();
            const uploadDate = `${now.getFullYear()}年${(now.getMonth() + 1).toString().padStart(2, '0')}月${now.getDate().toString().padStart(2, '0')}日 ${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
            
            if (editingItem !== null) {
                // 更新现有网点
                systemData.networkPoints[editingItem] = {
                    images: images,
                    date: uploadDate
                };
            } else {
                // 添加新网点
                systemData.networkPoints.push({
                    images: images,
                    date: uploadDate
                });
            }
            
            saveData();
            loadTabData();
            document.getElementById('networkModal').style.display = 'none';
            editingItem = null;
            alert('网点信息保存成功！');
        }
        
        // 打开资费弹窗
        function openPricingModal(editIndex = null) {
            editingItem = editIndex;
            const modal = document.getElementById('pricingModal');
            const form = document.getElementById('pricingForm');
            const preview = document.getElementById('pricingPreview');
            
            // 重置表单
            form.reset();
            preview.innerHTML = '';
            document.getElementById('pricingImages').value = '';
            
            // 如果是编辑模式，加载数据
            if (editIndex !== null && systemData.pricing[editIndex]) {
                const item = systemData.pricing[editIndex];
                item.images.forEach((image, index) => {
                    const previewItem = document.createElement('div');
                    previewItem.className = 'preview-item';
                    previewItem.innerHTML = `
                        <img src="${image}" alt="资费图片 ${index + 1}">
                        <button type="button" class="remove-img" data-index="${index}">&times;</button>
                    `;
                    preview.appendChild(previewItem);
                });
            }
            
            modal.style.display = 'flex';
        }
        
        // 保存资费
        function savePricing() {
            const imagePreviews = document.getElementById('pricingPreview').querySelectorAll('img');
            if (imagePreviews.length === 0) {
                alert('请至少上传一张图片！');
                return;
            }
            
            // 获取图片数据
            const images = [];
            imagePreviews.forEach(img => {
                images.push(img.src);
            });
            
            // 生成当前时间
            const now = new Date();
            const uploadDate = `${now.getFullYear()}年${(now.getMonth() + 1).toString().padStart(2, '0')}月${now.getDate().toString().padStart(2, '0')}日 ${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
            
            if (editingItem !== null) {
                // 更新现有资费
                systemData.pricing[editingItem] = {
                    images: images,
                    date: uploadDate
                };
            } else {
                // 添加新资费
                systemData.pricing.push({
                    images: images,
                    date: uploadDate
                });
            }
            
            saveData();
            loadTabData();
            document.getElementById('pricingModal').style.display = 'none';
            editingItem = null;
            alert('资费信息保存成功！');
        }
        
        // 打开在柜信息弹窗
        function openCabinetModal(editIndex = null) {
            editingItem = editIndex;
            const modal = document.getElementById('cabinetModal');
            const form = document.getElementById('cabinetForm');
            const title = document.getElementById('cabinetModalTitle');
            
            // 重置表单
            form.reset();
            
            if (editIndex !== null && systemData.cabinetItems[editIndex]) {
                // 编辑模式
                title.textContent = '修改在柜信息';
                const item = systemData.cabinetItems[editIndex];
                document.getElementById('cabinetArea').value = item.area;
                document.getElementById('cabinetDistrict').value = item.district;
                document.getElementById('cabinetNumber').value = item.number;
                document.getElementById('cabinetType').value = item.type;
                document.getElementById('cabinetLocation').value = item.location;
                document.getElementById('cabinetStatus').value = item.status;
                document.getElementById('cabinetId').value = editIndex;
            } else {
                // 添加模式
                title.textContent = '添加入柜信息';
                document.getElementById('cabinetId').value = '';
            }
            
            modal.style.display = 'flex';
        }
        
        // 保存在柜信息
        function saveCabinetItem() {
            const area = document.getElementById('cabinetArea').value;
            const district = document.getElementById('cabinetDistrict').value;
            const number = document.getElementById('cabinetNumber').value;
            const type = document.getElementById('cabinetType').value;
            const location = document.getElementById('cabinetLocation').value;
            const status = document.getElementById('cabinetStatus').value;
            const id = document.getElementById('cabinetId').value;
            
            if (!area || !district || !number || !type || !location || !status) {
                alert('请填写所有字段！');
                return;
            }
            
            const item = {
                area,
                district,
                number,
                type,
                location,
                status
            };
            
            if (id !== '') {
                // 更新现有项
                systemData.cabinetItems[id] = item;
            } else {
                // 添加新项
                systemData.cabinetItems.push(item);
            }
            
            saveData();
            loadTabData();
            document.getElementById('cabinetModal').style.display = 'none';
            editingItem = null;
            alert('在柜信息保存成功！');
        }
        
        // 打开取件人弹窗
        function openRecipientModal(editIndex = null) {
            editingItem = editIndex;
            const modal = document.getElementById('recipientModal');
            const form = document.getElementById('recipientForm');
            const title = document.getElementById('recipientModalTitle');
            
            // 重置表单
            form.reset();
            
            if (editIndex !== null && systemData.recipients[editIndex]) {
                // 编辑模式
                title.textContent = '修改取件人信息';
                const item = systemData.recipients[editIndex];
                document.getElementById('recipientNumber').value = item.number;
                document.getElementById('recipientName').value = item.name;
                document.getElementById('recipientPhone').value = item.phone;
                document.getElementById('recipientId').value = item.idNumber;
                document.getElementById('recipientDataId').value = editIndex;
            } else {
                // 添加模式
                title.textContent = '添加取件人信息';
                document.getElementById('recipientDataId').value = '';
            }
            
            modal.style.display = 'flex';
        }
        
        // 保存取件人信息
        function saveRecipient() {
            const number = document.getElementById('recipientNumber').value;
            const name = document.getElementById('recipientName').value;
            const phone = document.getElementById('recipientPhone').value;
            const idNumber = document.getElementById('recipientId').value;
            const id = document.getElementById('recipientDataId').value;
            
            if (!number || !name || !phone || !idNumber) {
                alert('请填写所有字段！');
                return;
            }
            
            if (idNumber.length !== 4) {
                alert('身份证明号码后四位必须为4位数字！');
                return;
            }
            
            const item = {
                number,
                name,
                phone,
                idNumber
            };
            
            if (id !== '') {
                // 更新现有项
                systemData.recipients[id] = item;
            } else {
                // 添加新项
                systemData.recipients.push(item);
            }
            
            saveData();
            loadTabData();
            document.getElementById('recipientModal').style.display = 'none';
            editingItem = null;
            alert('取件人信息保存成功！');
        }
        
        // 打开戳戳我弹窗
        function openPokeModal() {
            const modal = document.getElementById('pokeModal');
            const form = document.getElementById('pokeForm');
            const preview = document.getElementById('pokePreview');
            
            // 重置表单
            form.reset();
            preview.innerHTML = '';
            document.getElementById('pokeImage').value = '';
            
            // 如果已有图片，显示预览
            if (systemData.pokeImage) {
                const previewItem = document.createElement('div');
                previewItem.className = 'preview-item';
                previewItem.innerHTML = `
                    <img src="${systemData.pokeImage}" alt="戳戳我图片">
                `;
                preview.appendChild(previewItem);
            }
            
            modal.style.display = 'flex';
        }
        
        // 保存戳戳我图片
        function savePoke() {
            const imagePreviews = document.getElementById('pokePreview').querySelectorAll('img');
            if (imagePreviews.length === 0) {
                alert('请上传图片！');
                return;
            }
            
            // 获取图片数据
            systemData.pokeImage = imagePreviews[0].src;
            
            saveData();
            loadTabData();
            document.getElementById('pokeModal').style.display = 'none';
            alert('戳戳我图片保存成功！');
        }
        
        // 打开LOGO弹窗
        function openLogoModal() {
            const modal = document.getElementById('logoModal');
            const form = document.getElementById('logoForm');
            const preview = document.getElementById('logoUploadPreview');
            
            // 重置表单
            form.reset();
            preview.innerHTML = '';
            document.getElementById('logoImage').value = '';
            
            modal.style.display = 'flex';
        }
        
        // 保存LOGO
        function saveLogo() {
            const imagePreviews = document.getElementById('logoUploadPreview').querySelectorAll('img');
            if (imagePreviews.length === 0) {
                alert('请上传LOGO图片！');
                return;
            }
            
            // 获取图片数据
            systemData.logo = imagePreviews[0].src;
            
            saveData();
            applyLogoAndBackground();
            document.getElementById('logoModal').style.display = 'none';
            alert('LOGO保存成功！');
        }
        
        // 删除LOGO
        function removeLogo() {
            systemData.logo = null;
            saveData();
            applyLogoAndBackground();
            alert('LOGO已删除！');
        }
        
        // 打开背景弹窗
        function openBackgroundModal() {
            const modal = document.getElementById('backgroundModal');
            const form = document.getElementById('backgroundForm');
            const preview = document.getElementById('backgroundUploadPreview');
            
            // 重置表单
            form.reset();
            preview.innerHTML = '';
            document.getElementById('backgroundImage').value = '';
            
            modal.style.display = 'flex';
        }
        
        // 保存背景
        function saveBackground() {
            const imagePreviews = document.getElementById('backgroundUploadPreview').querySelectorAll('img');
            if (imagePreviews.length === 0) {
                alert('请上传背景图片！');
                return;
            }
            
            // 获取图片数据
            systemData.background = imagePreviews[0].src;
            
            saveData();
            applyLogoAndBackground();
            document.getElementById('backgroundModal').style.display = 'none';
            alert('背景图片保存成功！');
        }
        
        // 删除背景
        function removeBackground() {
            systemData.background = null;
            saveData();
            applyLogoAndBackground();
            alert('背景图片已删除！');
        }
        
        // 应用LOGO和背景
        function applyLogoAndBackground() {
            const logoDisplay = document.getElementById('logoDisplay');
            const removeLogoBtn = document.getElementById('removeLogoBtn');
            const removeBgBtn = document.getElementById('removeBgBtn');
            
            // 应用LOGO
            if (systemData.logo) {
                logoDisplay.innerHTML = `<img src="${systemData.logo}" alt="LOGO" class="logo" onclick="viewImage('${systemData.logo}')">`;
                removeLogoBtn.disabled = false;
            } else {
                logoDisplay.innerHTML = 'LOGO';
                logoDisplay.className = 'logo-placeholder';
                removeLogoBtn.disabled = true;
            }
            
            // 应用背景
            if (systemData.background) {
                document.body.style.backgroundImage = `url('${systemData.background}')`;
                removeBgBtn.disabled = false;
            } else {
                document.body.style.backgroundImage = '';
                removeBgBtn.disabled = true;
            }
        }
        
        // 查看图片
        function viewImage(src) {
            document.getElementById('viewedImage').src = src;
            document.getElementById('imageViewerModal').style.display = 'flex';
        }
        
        // 加载标签页数据
        function loadTabData() {
            loadAnnouncements();
            loadNetworkPoints();
            loadPricing();
            loadCabinetItems();
            loadRecipients();
            loadPoke();
        }
        
        // 加载公告数据
        function loadAnnouncements() {
            const container = document.getElementById('announcementContainer');
            if (!systemData.announcements || systemData.announcements.length === 0) {
                container.innerHTML = `
                    <div class="no-data">
                        <i class="fas fa-bullhorn"></i>
                        <p>暂无公告信息，点击"上传公告"添加第一条公告</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = '';
            systemData.announcements.forEach((item, index) => {
                item.images.forEach((image, imgIndex) => {
                    const imageItem = document.createElement('div');
                    imageItem.className = 'image-item';
                    imageItem.innerHTML = `
                        <img src="${image}" alt="公告图片 ${imgIndex + 1}" onclick="viewImage('${image}')">
                        <div class="image-info">
                            <div class="image-title">公告图片 ${imgIndex + 1}</div>
                            <div class="image-date">上传时间: ${item.date}</div>
                            <div class="image-actions">
                                <button class="btn btn-accent" onclick="editAnnouncement(${index})">修改</button>
                                <button class="btn btn-danger" onclick="deleteAnnouncement(${index})">删除</button>
                            </div>
                        </div>
                    `;
                    container.appendChild(imageItem);
                });
            });
        }
        
        // 编辑公告
        function editAnnouncement(index) {
            showPasswordModal('announcement');
            // 密码验证通过后会打开弹窗，这里需要保存索引
            setTimeout(() => {
                if (document.getElementById('passwordModal').style.display !== 'flex') {
                    openAnnouncementModal(index);
                }
            }, 100);
        }
        
        // 删除公告
        function deleteAnnouncement(index) {
            if (confirm('确定要删除这条公告吗？')) {
                systemData.announcements.splice(index, 1);
                saveData();
                loadTabData();
                alert('公告已删除！');
            }
        }
        
        // 加载网点数据
        function loadNetworkPoints() {
            const container = document.getElementById('networkContainer');
            if (!systemData.networkPoints || systemData.networkPoints.length === 0) {
                container.innerHTML = `
                    <div class="no-data">
                        <i class="fas fa-map-marker-alt"></i>
                        <p>暂无网点信息，点击"上传网点"添加第一条网点信息</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = '';
            systemData.networkPoints.forEach((item, index) => {
                item.images.forEach((image, imgIndex) => {
                    const imageItem = document.createElement('div');
                    imageItem.className = 'image-item';
                    imageItem.innerHTML = `
                        <img src="${image}" alt="网点图片 ${imgIndex + 1}" onclick="viewImage('${image}')">
                        <div class="image-info">
                            <div class="image-title">网点图片 ${imgIndex + 1}</div>
                            <div class="image-date">上传时间: ${item.date}</div>
                            <div class="image-actions">
                                <button class="btn btn-accent" onclick="editNetwork(${index})">修改</button>
                                <button class="btn btn-danger" onclick="deleteNetwork(${index})">删除</button>
                            </div>
                        </div>
                    `;
                    container.appendChild(imageItem);
                });
            });
        }
        
        // 编辑网点
        function editNetwork(index) {
            showPasswordModal('network');
            setTimeout(() => {
                if (document.getElementById('passwordModal').style.display !== 'flex') {
                    openNetworkModal(index);
                }
            }, 100);
        }
        
        // 删除网点
        function deleteNetwork(index) {
            if (confirm('确定要删除这条网点信息吗？')) {
                systemData.networkPoints.splice(index, 1);
                saveData();
                loadTabData();
                alert('网点信息已删除！');
            }
        }
        
        // 加载资费数据
        function loadPricing() {
            const container = document.getElementById('pricingContainer');
            if (!systemData.pricing || systemData.pricing.length === 0) {
                container.innerHTML = `
                    <div class="no-data">
                        <i class="fas fa-money-bill-wave"></i>
                        <p>暂无资费信息，点击"上传资费"添加第一条资费信息</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = '';
            systemData.pricing.forEach((item, index) => {
                item.images.forEach((image, imgIndex) => {
                    const imageItem = document.createElement('div');
                    imageItem.className = 'image-item';
                    imageItem.innerHTML = `
                        <img src="${image}" alt="资费图片 ${imgIndex + 1}" onclick="viewImage('${image}')">
                        <div class="image-info">
                            <div class="image-title">资费图片 ${imgIndex + 1}</div>
                            <div class="image-date">上传时间: ${item.date}</div>
                            <div class="image-actions">
                                <button class="btn btn-accent" onclick="editPricing(${index})">修改</button>
                                <button class="btn btn-danger" onclick="deletePricing(${index})">删除</button>
                            </div>
                        </div>
                    `;
                    container.appendChild(imageItem);
                });
            });
        }
        
        // 编辑资费
        function editPricing(index) {
            showPasswordModal('pricing');
            setTimeout(() => {
                if (document.getElementById('passwordModal').style.display !== 'flex') {
                    openPricingModal(index);
                }
            }, 100);
        }
        
        // 删除资费
        function deletePricing(index) {
            if (confirm('确定要删除这条资费信息吗？')) {
                systemData.pricing.splice(index, 1);
                saveData();
                loadTabData();
                alert('资费信息已删除！');
            }
        }
        
        // 加载在柜信息
        function loadCabinetItems() {
            const tbody = document.querySelector('#cabinetTable tbody');
            if (!systemData.cabinetItems || systemData.cabinetItems.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="7" style="text-align: center; padding: 40px;">
                            <i class="fas fa-box-open" style="font-size: 48px; color: #ccc; margin-bottom: 15px;"></i>
                            <p>暂无在柜信息，点击"添加入柜信息"添加第一条记录</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            tbody.innerHTML = '';
            systemData.cabinetItems.forEach((item, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${item.area}</td>
                    <td>${item.district}</td>
                    <td>${item.number}</td>
                    <td>${item.type}</td>
                    <td>${item.location}</td>
                    <td><span class="status-badge ${item.status === '已入柜' ? 'status-in' : 'status-out'}">${item.status}</span></td>
                    <td>
                        <button class="btn btn-accent" onclick="editCabinetItem(${index})">修改</button>
                        <button class="btn btn-danger" onclick="deleteCabinetItem(${index})">删除</button>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }
        
        // 编辑在柜信息
        function editCabinetItem(index) {
            openCabinetModal(index);
        }
        
        // 删除在柜信息
        function deleteCabinetItem(index) {
            if (confirm('确定要删除这条在柜信息吗？')) {
                systemData.cabinetItems.splice(index, 1);
                saveData();
                loadTabData();
                alert('在柜信息已删除！');
            }
        }
        
        // 加载取件人信息
    function loadRecipients() {
        const tbody = document.querySelector('#recipientTable tbody');
        if (!systemData.recipients || systemData.recipients.length === 0) {
            tbody.innerHTML = `
                <tr>
                    <td colspan="5" style="text-align: center; padding: 40px;">
                        <i class="fas fa-users" style="font-size: 48px; color: #ccc; margin-bottom: 15px;"></i>
                        <p>暂无取件人信息，点击"添加取件人"添加第一条记录</p>
                    </td>
                </tr>
            `;
            return;
        }
        
        tbody.innerHTML = '';
        systemData.recipients.forEach((item, index) => {
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>${item.number}</td>
                <td>${item.name}</td>
                <td>${item.phone}</td>
                <td>${item.idNumber}</td>
                <td>
                    <button class="btn btn-accent" onclick="editRecipient(${index})">修改</button>
                    <button class="btn btn-danger" onclick="deleteRecipient(${index})">删除</button>
                </td>
            `;
            tbody.appendChild(row);
        });
    }
    
    // 编辑取件人信息
    function editRecipient(index) {
        openRecipientModal(index);
    }
    
    // 删除取件人信息
    function deleteRecipient(index) {
        if (confirm('确定要删除这条取件人信息吗？')) {
            systemData.recipients.splice(index, 1);
            saveData();
            loadTabData();
            alert('取件人信息已删除！');
        }
    }
    
    // 加载戳戳我信息
    function loadPoke() {
        const container = document.getElementById('pokeContent');
        if (!systemData.pokeImage) {
            container.innerHTML = `
                <div class="no-data">
                    <i class="fas fa-smile-wink"></i>
                    <p>暂无内容，点击"上传图片"添加图片</p>
                </div>
            `;
            return;
        }
        
        container.innerHTML = `
            <img src="${systemData.pokeImage}" alt="戳戳我" class="poke-image" onclick="viewImage('${systemData.pokeImage}')">
            <div style="margin-top: 20px; text-align: center;">
                <button class="btn btn-accent" onclick="editPoke()">修改图片</button>
                <button class="btn btn-danger" onclick="deletePoke()">删除图片</button>
            </div>
        `;
    }
    
    // 编辑戳戳我图片
    function editPoke() {
        showPasswordModal('poke');
        setTimeout(() => {
            if (document.getElementById('passwordModal').style.display !== 'flex') {
                openPokeModal();
            }
        }, 100);
    }
    
    // 删除戳戳我图片
    function deletePoke() {
        if (confirm('确定要删除戳戳我图片吗？')) {
            systemData.pokeImage = null;
            saveData();
            loadTabData();
            alert('戳戳我图片已删除！');
        }
    }
    
    // 保存数据到localStorage
    function saveData() {
        try {
            // 由于图片数据是base64字符串，可能会非常大，所以需要压缩处理
            const dataToSave = JSON.parse(JSON.stringify(systemData));
            
            // 如果数据太大，尝试清理旧数据
            if (JSON.stringify(dataToSave).length > 5000000) { // 大约5MB
                alert('数据量较大，建议删除一些旧图片以释放存储空间');
            }
            
            localStorage.setItem('lyonStorageSystem', JSON.stringify(dataToSave));
        } catch (error) {
            console.error('保存数据失败:', error);
            alert('保存数据失败，可能数据量过大。请尝试删除一些不必要的图片。');
        }
    }
    
    // 从localStorage加载数据
    function loadData() {
        const savedData = localStorage.getItem('lyonStorageSystem');
        if (savedData) {
            try {
                systemData = JSON.parse(savedData);
                
                // 确保所有必需的数组都存在
                if (!systemData.announcements) systemData.announcements = [];
                if (!systemData.networkPoints) systemData.networkPoints = [];
                if (!systemData.pricing) systemData.pricing = [];
                if (!systemData.cabinetItems) systemData.cabinetItems = [];
                if (!systemData.recipients) systemData.recipients = [];
                
                // 确保单个数据项存在
                if (!systemData.pokeImage) systemData.pokeImage = null;
                if (!systemData.logo) systemData.logo = null;
                if (!systemData.background) systemData.background = null;
                
            } catch (error) {
                console.error('加载数据失败:', error);
                alert('加载数据失败，将使用默认数据');
                resetData();
            }
        } else {
            resetData();
        }
    }
    
    // 重置数据
    function resetData() {
        systemData = {
            announcements: [],
            networkPoints: [],
            pricing: [],
            cabinetItems: [],
            recipients: [],
            pokeImage: null,
            logo: null,
            background: null
        };
    }
    
    // 页面卸载前保存当前标签页
    window.addEventListener('beforeunload', function() {
        localStorage.setItem('currentTab', currentTab);
    });
    
    // 键盘快捷键支持
    document.addEventListener('keydown', function(e) {
        // ESC键关闭所有弹窗
        if (e.key === 'Escape') {
            const modals = document.querySelectorAll('.modal-overlay');
            modals.forEach(modal => {
                modal.style.display = 'none';
            });
            editingItem = null;
        }
        
        // 密码输入框按Enter键提交
        if (e.key === 'Enter' && document.getElementById('passwordModal').style.display === 'flex') {
            document.getElementById('submitPasswordBtn').click();
        }
    });
    
    // 导出数据功能（可选）
    function exportData() {
        const dataStr = JSON.stringify(systemData, null, 2);
        const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
        
        const exportFileDefaultName = '里昂星储系统数据备份.json';
        
        const linkElement = document.createElement('a');
        linkElement.setAttribute('href', dataUri);
        linkElement.setAttribute('download', exportFileDefaultName);
        linkElement.click();
    }
    
    // 导入数据功能（可选）
    function importData() {
        if (confirm('导入数据将覆盖当前所有数据，是否继续？')) {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = function(event) {
                const file = event.target.files[0];
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    try {
                        const importedData = JSON.parse(e.target.result);
                        systemData = importedData;
                        saveData();
                        loadTabData();
                        applyLogoAndBackground();
                        alert('数据导入成功！');
                    } catch (error) {
                        alert('导入失败，文件格式不正确！');
                    }
                };
                
                reader.readAsText(file);
            };
            
            input.click();
        }
    }
    
    // 添加快捷操作按钮到设置页面
    document.addEventListener('DOMContentLoaded', function() {
        // 在设置页面添加数据管理部分
        const settingsContainer = document.querySelector('.settings-container');
        if (settingsContainer) {
            const dataManagement = document.createElement('div');
            dataManagement.className = 'setting-item';
            dataManagement.style.gridColumn = '1 / -1';
            dataManagement.innerHTML = `
                <h3>数据管理</h3>
                <p>备份和恢复系统数据</p>
                <div style="margin-top: 20px; display: flex; gap: 10px;">
                    <button class="btn btn-accent" id="exportDataBtn">
                        <i class="fas fa-file-export"></i> 导出数据
                    </button>
                    <button class="btn btn-accent" id="importDataBtn">
                        <i class="fas fa-file-import"></i> 导入数据
                    </button>
                    <button class="btn btn-danger" id="resetDataBtn">
                        <i class="fas fa-trash-alt"></i> 重置所有数据
                    </button>
                </div>
            `;
            settingsContainer.appendChild(dataManagement);
            
            // 添加快捷操作按钮事件
            document.getElementById('exportDataBtn').addEventListener('click', exportData);
            document.getElementById('importDataBtn').addEventListener('click', importData);
            document.getElementById('resetDataBtn').addEventListener('click', function() {
                if (confirm('确定要重置所有数据吗？此操作不可恢复！')) {
                    resetData();
                    saveData();
                    loadTabData();
                    applyLogoAndBackground();
                    alert('所有数据已重置！');
                }
            });
        }
    });
    
    // 添加搜索功能（可选扩展）
    function addSearchFunctionality() {
        // 在柜信息搜索
        const cabinetSearch = document.createElement('div');
        cabinetSearch.style.marginBottom = '20px';
        cabinetSearch.innerHTML = `
            <div style="display: flex; align-items: center; gap: 10px;">
                <input type="text" id="cabinetSearchInput" placeholder="搜索在柜信息..." style="flex-grow: 1;">
                <button class="btn" id="cabinetSearchBtn">
                    <i class="fas fa-search"></i> 搜索
                </button>
                <button class="btn" id="cabinetResetSearchBtn">
                    <i class="fas fa-undo"></i> 重置
                </button>
            </div>
        `;
        
        const cabinetSection = document.querySelector('#cabinet .section-title');
        if (cabinetSection) {
            cabinetSection.parentNode.insertBefore(cabinetSearch, cabinetSection.nextSibling);
            
            // 搜索功能实现
            document.getElementById('cabinetSearchBtn').addEventListener('click', function() {
                const searchTerm = document.getElementById('cabinetSearchInput').value.toLowerCase();
                if (!searchTerm) return;
                
                const filteredItems = systemData.cabinetItems.filter(item => 
                    item.area.toLowerCase().includes(searchTerm) ||
                    item.district.toLowerCase().includes(searchTerm) ||
                    item.number.toLowerCase().includes(searchTerm) ||
                    item.type.toLowerCase().includes(searchTerm) ||
                    item.location.toLowerCase().includes(searchTerm) ||
                    item.status.toLowerCase().includes(searchTerm)
                );
                
                const tbody = document.querySelector('#cabinetTable tbody');
                if (filteredItems.length === 0) {
                    tbody.innerHTML = `
                        <tr>
                            <td colspan="7" style="text-align: center; padding: 40px;">
                                <i class="fas fa-search" style="font-size: 48px; color: #ccc; margin-bottom: 15px;"></i>
                                <p>未找到匹配的在柜信息</p>
                            </td>
                        </tr>
                    `;
                } else {
                    tbody.innerHTML = '';
                    filteredItems.forEach((item, index) => {
                        const originalIndex = systemData.cabinetItems.findIndex(original => 
                            original.number === item.number && 
                            original.location === item.location
                        );
                        
                        const row = document.createElement('tr');
                        row.innerHTML = `
                            <td>${item.area}</td>
                            <td>${item.district}</td>
                            <td>${item.number}</td>
                            <td>${item.type}</td>
                            <td>${item.location}</td>
                            <td><span class="status-badge ${item.status === '已入柜' ? 'status-in' : 'status-out'}">${item.status}</span></td>
                            <td>
                                <button class="btn btn-accent" onclick="editCabinetItem(${originalIndex})">修改</button>
                                <button class="btn btn-danger" onclick="deleteCabinetItem(${originalIndex})">删除</button>
                            </td>
                        `;
                        tbody.appendChild(row);
                    });
                }
            });
            
            // 重置搜索
            document.getElementById('cabinetResetSearchBtn').addEventListener('click', function() {
                document.getElementById('cabinetSearchInput').value = '';
                loadCabinetItems();
            });
        }
    }
    
    // 页面完全加载后添加搜索功能
    window.addEventListener('load', function() {
        // 延迟添加搜索功能，避免影响主要功能
        setTimeout(addSearchFunctionality, 1000);
        
        // 添加帮助提示
        addHelpTooltips();
    });
    
    // 添加帮助提示
    function addHelpTooltips() {
        // 为管理按钮添加提示
        const adminButtons = document.querySelectorAll('.btn');
        adminButtons.forEach(btn => {
            if (btn.textContent.includes('上传') || btn.textContent.includes('添加')) {
                btn.title = '点击此按钮进行上传操作';
            }
        });
        
        // 添加键盘快捷键提示
        const helpText = document.createElement('div');
        helpText.style.position = 'fixed';
        helpText.style.bottom = '10px';
        helpText.style.right = '10px';
        helpText.style.backgroundColor = 'rgba(255,255,255,0.9)';
        helpText.style.padding = '10px';
        helpText.style.borderRadius = '5px';
        helpText.style.fontSize = '12px';
        helpText.style.boxShadow = '0 2px 5px rgba(0,0,0,0.2)';
        helpText.style.zIndex = '100';
        helpText.innerHTML = '<strong>提示：</strong>按ESC键可关闭弹窗';
        document.body.appendChild(helpText);
        
        // 5秒后自动隐藏提示
        setTimeout(() => {
            helpText.style.display = 'none';
        }, 5000);
    }
    
    // 添加响应式调整
    function handleResize() {
        const isMobile = window.innerWidth < 768;
        
        // 调整图片网格列数
        const imageContainers = document.querySelectorAll('.images-container');
        imageContainers.forEach(container => {
            if (isMobile) {
                container.style.gridTemplateColumns = '1fr';
            } else {
                container.style.gridTemplateColumns = 'repeat(auto-fill, minmax(300px, 1fr))';
            }
        });
        
        // 调整表格显示
        const tables = document.querySelectorAll('table');
        tables.forEach(table => {
            if (isMobile) {
                table.style.fontSize = '14px';
            } else {
                table.style.fontSize = '16px';
            }
        });
    }
    
    window.addEventListener('resize', handleResize);
    handleResize(); // 初始调用
    
    // 添加打印功能
    function printTable(tableId) {
        const table = document.getElementById(tableId);
        if (!table) return;
        
        const printWindow = window.open('', '_blank');
        printWindow.document.write(`
            <html>
            <head>
                <title>里昂星储 - 打印</title>
                <style>
                    body { font-family: Arial, sans-serif; }
                    table { width: 100%; border-collapse: collapse; margin: 20px 0; }
                    th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                    th { background-color: #f2f2f2; }
                    h1 { color: #1a4b8c; }
                    .print-date { margin-bottom: 20px; }
                </style>
            </head>
            <body>
                <h1>里昂星储查询系统</h1>
                <div class="print-date">打印时间: ${new Date().toLocaleString('zh-CN')}</div>
                ${table.outerHTML}
            </body>
            </html>
        `);
        printWindow.document.close();
        printWindow.print();
    }
    
    // 为表格添加打印按钮
    document.addEventListener('DOMContentLoaded', function() {
        // 在柜信息表格添加打印按钮
        const cabinetTitle = document.querySelector('#cabinet .section-title');
        if (cabinetTitle) {
            const printBtn = document.createElement('button');
            printBtn.className = 'btn btn-accent';
            printBtn.innerHTML = '<i class="fas fa-print"></i> 打印';
            printBtn.style.marginLeft = '10px';
            printBtn.onclick = function() { printTable('cabinetTable'); };
            cabinetTitle.querySelector('span').appendChild(printBtn);
        }
        
        // 取件人信息表格添加打印按钮
        const recipientTitle = document.querySelectorAll('#cabinet .section-title')[1];
        if (recipientTitle) {
            const printBtn = document.createElement('button');
            printBtn.className = 'btn btn-accent';
            printBtn.innerHTML = '<i class="fas fa-print"></i> 打印';
            printBtn.style.marginLeft = '10px';
            printBtn.onclick = function() { printTable('recipientTable'); };
            recipientTitle.querySelector('span').appendChild(printBtn);
        }
    });
    
    // 初始化完成提示
    console.log('里昂星储查询系统初始化完成');
    console.log('系统功能包括：公告管理、网点清单、资费清单、在柜信息管理、系统设置、戳戳我等功能');
    console.log('默认管理密码：740302');
</script>
</body>
</html>
