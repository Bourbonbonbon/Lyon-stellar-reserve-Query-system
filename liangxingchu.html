<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>里昂星储—查询系统</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #2c3e50;
            --border-color: #bdc3c7;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --success-color: #27ae60;
        }
        
        body {
            background-color: #f5f7fa;
            color: var(--dark-color);
            transition: background-image 0.5s;
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* 头部样式 */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 0;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 10px;
            padding: 20px;
            box-shadow: var(--shadow);
        }
        
        .logo-container {
            display: flex;
            align-items: center;
        }
        
        .logo {
            width: 75px;
            height: 75px;
            border-radius: 10px;
            object-fit: cover;
            border: 2px solid var(--primary-color);
            margin-right: 15px;
            cursor: pointer;
        }
        
        .logo-placeholder {
            width: 75px;
            height: 75px;
            border-radius: 10px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 12px;
            text-align: center;
            margin-right: 15px;
        }
        
        .site-title h1 {
            color: var(--primary-color);
            font-size: 28px;
            margin-bottom: 5px;
        }
        
        .site-title p {
            color: #7f8c8d;
            font-size: 14px;
        }
        
        /* 标签页导航 */
        .tabs {
            display: flex;
            flex-wrap: wrap;
            background-color: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
        }
        
        .tab {
            flex: 1;
            min-width: 120px;
            text-align: center;
            padding: 15px 10px;
            cursor: pointer;
            background-color: #f5f5f5;
            border-right: 1px solid var(--border-color);
            transition: all 0.3s;
            font-weight: 600;
            color: #7f8c8d;
        }
        
        .tab:last-child {
            border-right: none;
        }
        
        .tab:hover {
            background-color: #e8e8e8;
        }
        
        .tab.active {
            background-color: var(--primary-color);
            color: white;
        }
        
        .tab i {
            margin-right: 8px;
        }
        
        /* 标签页内容 */
        .tab-content {
            display: none;
            background-color: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: var(--shadow);
            min-height: 500px;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* 标题样式 */
        .tab-title {
            font-size: 22px;
            margin-bottom: 20px;
            color: var(--primary-color);
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        /* 数据展示区域 */
        .data-display {
            margin-bottom: 30px;
            max-height: 500px;
            overflow-y: auto;
            padding: 10px;
            border: 1px solid #eee;
            border-radius: 8px;
        }
        
        .empty-message {
            text-align: center;
            color: #aaa;
            padding: 40px 0;
            font-size: 16px;
        }
        
        /* 图片网格布局 */
        .image-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .image-item {
            background-color: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s;
        }
        
        .image-item:hover {
            transform: translateY(-5px);
        }
        
        .item-img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            cursor: pointer;
        }
        
        .item-info {
            padding: 15px;
        }
        
        .item-title {
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 16px;
        }
        
        .item-detail {
            font-size: 13px;
            color: #666;
            margin-bottom: 5px;
        }
        
        /* 表单样式 */
        .upload-form {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            border-left: 4px solid var(--secondary-color);
        }
        
        .form-title {
            font-size: 18px;
            margin-bottom: 15px;
            color: var(--primary-color);
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            font-size: 14px;
        }
        
        .form-control {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            font-size: 14px;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--secondary-color);
        }
        
        .form-row {
            display: flex;
            gap: 15px;
        }
        
        .form-row .form-group {
            flex: 1;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #1a252f;
        }
        
        .btn-secondary {
            background-color: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background-color: #5a6268;
        }
        
        .btn-danger {
            background-color: var(--accent-color);
            color: white;
        }
        
        .btn-danger:hover {
            background-color: #c0392b;
        }
        
        .btn-success {
            background-color: var(--success-color);
            color: white;
        }
        
        .btn-success:hover {
            background-color: #219653;
        }
        
        .btn-small {
            padding: 5px 10px;
            font-size: 12px;
        }
        
        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        /* 密码保护样式 */
        .password-protection {
            background-color: #fff9e6;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #ffcc00;
        }
        
        .password-form {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        /* 模态框样式 */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background-color: white;
            border-radius: 10px;
            max-width: 90%;
            max-height: 90%;
            overflow: auto;
            padding: 20px;
        }
        
        .modal-img {
            max-width: 100%;
            max-height: 70vh;
            display: block;
            margin: 0 auto;
        }
        
        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            color: white;
            font-size: 30px;
            cursor: pointer;
        }
        
        /* 在柜信息表格样式 */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        
        .data-table th, .data-table td {
            border: 1px solid #ddd;
            padding: 12px 15px;
            text-align: left;
        }
        
        .data-table th {
            background-color: #f2f2f2;
            font-weight: 600;
        }
        
        .data-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        .data-table tr:hover {
            background-color: #f5f5f5;
        }
        
        .status-badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .status-in {
            background-color: #d4edda;
            color: #155724;
        }
        
        .status-out {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        .type-badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            background-color: #e3f2fd;
            color: #0d47a1;
        }
        
        /* 戳戳我特殊样式 */
        .poke-image {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .poke-image img {
            max-width: 300px;
            max-height: 300px;
            border-radius: 10px;
            cursor: pointer;
        }
        
        /* 设置页面样式 */
        .settings-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
        }
        
        .setting-item {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
        }
        
        .setting-item h3 {
            margin-bottom: 15px;
            color: var(--primary-color);
        }
        
        .preview-area {
            width: 150px;
            height: 150px;
            border: 2px dashed #ccc;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 15px auto;
            overflow: hidden;
        }
        
        .preview-area img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        
        /* 响应式设计 */
        @media (max-width: 768px) {
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                border-right: none;
                border-bottom: 1px solid var(--border-color);
            }
            
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            
            .settings-grid {
                grid-template-columns: 1fr;
            }
            
            .image-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }
            
            .data-table {
                display: block;
                overflow-x: auto;
            }
        }
        
        /* 操作按钮 */
        .action-buttons {
            display: flex;
            gap: 5px;
            margin-top: 10px;
        }
        
        .data-item {
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            background-color: #fdfdfd;
        }
        
        /* 弹窗样式 */
        .popup-form {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .popup-content {
            background-color: white;
            border-radius: 10px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            padding: 25px;
        }
        
        .popup-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .popup-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }
        
        /* 文件上传限制提示 */
        .upload-limit {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }
        
        /* 选项卡内部分区 */
        .section {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }
        
        .section-title {
            font-size: 18px;
            margin-bottom: 15px;
            color: var(--secondary-color);
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo-container">
                <div id="logo-preview" class="logo-placeholder">LOGO</div>
                <div class="site-title">
                    <h1>里昂星储—查询系统</h1>
                    <p>智能仓储管理与信息查询平台</p>
                </div>
            </div>
        </header>
        
        <div class="tabs" id="tabs">
            <div class="tab active" data-tab="notice">
                <i class="fas fa-bullhorn"></i>公告
            </div>
            <div class="tab" data-tab="network">
                <i class="fas fa-map-marker-alt"></i>网点清单
            </div>
            <div class="tab" data-tab="fee">
                <i class="fas fa-money-bill-wave"></i>资费清单
            </div>
            <div class="tab" data-tab="cabinet">
                <i class="fas fa-archive"></i>在柜信息
            </div>
            <div class="tab" data-tab="settings">
                <i class="fas fa-cog"></i>设置
            </div>
            <div class="tab" data-tab="poke">
                <i class="fas fa-hand-point-up"></i>戳戳我
            </div>
        </div>
        
        <!-- 公告标签页 -->
        <div id="notice" class="tab-content active">
            <h2 class="tab-title"><i class="fas fa-bullhorn"></i> 系统公告</h2>
            
            <div class="data-display" id="notice-display">
                <div class="empty-message">暂无公告，请上传公告图片</div>
            </div>
            
            <div class="password-protection" id="notice-password-section">
                <h3>公告管理</h3>
                <p>请输入管理密码以添加或修改公告</p>
                <div class="password-form">
                    <input type="password" class="form-control" id="notice-password" placeholder="请输入管理密码">
                    <button class="btn btn-primary" id="notice-auth-btn">验证</button>
                </div>
            </div>
            
            <div class="upload-form" id="notice-upload-form" style="display: none;">
                <h3 class="form-title">上传公告图片</h3>
                <form id="notice-form">
                    <div class="form-group">
                        <label for="notice-file">公告图片 (JPG, JPEG, PNG) - 最多5张</label>
                        <input type="file" class="form-control" id="notice-file" accept=".jpg,.jpeg,.png" multiple>
                        <div class="upload-limit">最多可选择5张图片</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="notice-title">公告标题</label>
                        <input type="text" class="form-control" id="notice-title" placeholder="输入公告标题" required>
                    </div>
                    
                    <input type="hidden" id="notice-id">
                    
                    <div class="button-group">
                        <button type="submit" class="btn btn-primary">上传公告</button>
                        <button type="button" class="btn btn-secondary" id="notice-cancel-btn">取消</button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- 网点清单标签页 -->
        <div id="network" class="tab-content">
            <h2 class="tab-title"><i class="fas fa-map-marker-alt"></i> 网点清单</h2>
            
            <div class="data-display" id="network-display">
                <div class="empty-message">暂无网点清单，请上传网点清单图片</div>
            </div>
            
            <div class="password-protection" id="network-password-section">
                <h3>网点清单管理</h3>
                <p>请输入管理密码以添加或修改网点清单</p>
                <div class="password-form">
                    <input type="password" class="form-control" id="network-password" placeholder="请输入管理密码">
                    <button class="btn btn-primary" id="network-auth-btn">验证</button>
                </div>
            </div>
            
            <div class="upload-form" id="network-upload-form" style="display: none;">
                <h3 class="form-title">上传网点清单图片</h3>
                <form id="network-form">
                    <div class="form-group">
                        <label for="network-file">网点清单图片 (JPG, JPEG, PNG) - 最多5张</label>
                        <input type="file" class="form-control" id="network-file" accept=".jpg,.jpeg,.png" multiple>
                        <div class="upload-limit">最多可选择5张图片</div>
                    </div>
                    
                    <input type="hidden" id="network-id">
                    
                    <div class="button-group">
                        <button type="submit" class="btn btn-primary">上传网点清单</button>
                        <button type="button" class="btn btn-secondary" id="network-cancel-btn">取消</button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- 资费清单标签页 -->
        <div id="fee" class="tab-content">
            <h2 class="tab-title"><i class="fas fa-money-bill-wave"></i> 资费清单</h2>
            
            <div class="data-display" id="fee-display">
                <div class="empty-message">暂无资费清单，请上传资费清单图片</div>
            </div>
            
            <div class="password-protection" id="fee-password-section">
                <h3>资费清单管理</h3>
                <p>请输入管理密码以添加或修改资费清单</p>
                <div class="password-form">
                    <input type="password" class="form-control" id="fee-password" placeholder="请输入管理密码">
                    <button class="btn btn-primary" id="fee-auth-btn">验证</button>
                </div>
            </div>
            
            <div class="upload-form" id="fee-upload-form" style="display: none;">
                <h3 class="form-title">上传资费清单图片</h3>
                <form id="fee-form">
                    <div class="form-group">
                        <label for="fee-file">资费清单图片 (JPG, JPEG, PNG) - 最多5张</label>
                        <input type="file" class="form-control" id="fee-file" accept=".jpg,.jpeg,.png" multiple>
                        <div class="upload-limit">最多可选择5张图片</div>
                    </div>
                    
                    <input type="hidden" id="fee-id">
                    
                    <div class="button-group">
                        <button type="submit" class="btn btn-primary">上传资费清单</button>
                        <button type="button" class="btn btn-secondary" id="fee-cancel-btn">取消</button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- 在柜信息标签页 -->
        <div id="cabinet" class="tab-content">
            <h2 class="tab-title"><i class="fas fa-archive"></i> 在柜信息管理</h2>
            
            <!-- 在柜信息部分 -->
            <div class="section">
                <h3 class="section-title">在柜物品信息</h3>
                
                <div class="data-display" id="cabinet-display">
                    <div class="empty-message">等待数据上传</div>
                </div>
                
                <div class="button-group">
                    <button class="btn btn-primary" id="add-cabinet-btn">添 加 在 柜 信 息</button>
                </div>
            </div>
            
            <!-- 取件人信息部分 -->
            <div class="section">
                <h3 class="section-title">取件人信息</h3>
                
                <div class="data-display" id="receiver-display">
                    <div class="empty-message">等待数据上传</div>
                </div>
                
                <div class="button-group">
                    <button class="btn btn-primary" id="add-receiver-btn">添 加 取 件 人 信 息</button>
                </div>
            </div>
            
            <!-- 在柜信息弹窗表单 -->
            <div class="popup-form" id="cabinet-popup-form">
                <div class="popup-content">
                    <div class="popup-header">
                        <h3>在柜信息</h3>
                        <button class="popup-close" id="cabinet-popup-close">&times;</button>
                    </div>
                    
                    <form id="cabinet-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="cabinet-area">区域</label>
                                <input type="text" class="form-control" id="cabinet-area" placeholder="输入区域" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="cabinet-region">大区</label>
                                <input type="text" class="form-control" id="cabinet-region" placeholder="输入大区" required>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="cabinet-number">编号</label>
                                <input type="text" class="form-control" id="cabinet-number" placeholder="输入编号" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="cabinet-type">类型</label>
                                <select class="form-control" id="cabinet-type" required>
                                    <option value="">请选择类型</option>
                                    <option value="平信">平信</option>
                                    <option value="明信片">明信片</option>
                                    <option value="包裹">包裹</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="cabinet-location">存放位置（柜号）</label>
                                <input type="text" class="form-control" id="cabinet-location" placeholder="输入柜号" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="cabinet-status">状态</label>
                                <select class="form-control" id="cabinet-status" required>
                                    <option value="">请选择状态</option>
                                    <option value="已入柜">已入柜</option>
                                    <option value="已出柜">已出柜</option>
                                </select>
                            </div>
                        </div>
                        
                        <input type="hidden" id="cabinet-data-id">
                        
                        <div class="button-group">
                            <button type="submit" class="btn btn-primary">保存信息</button>
                            <button type="button" class="btn btn-secondary" id="cabinet-form-cancel-btn">取消</button>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- 取件人信息弹窗表单 -->
            <div class="popup-form" id="receiver-popup-form">
                <div class="popup-content">
                    <div class="popup-header">
                        <h3>取件人信息</h3>
                        <button class="popup-close" id="receiver-popup-close">&times;</button>
                    </div>
                    
                    <form id="receiver-form">
                        <div class="form-group">
                            <label for="receiver-cabinet-number">待取件编号</label>
                            <input type="text" class="form-control" id="receiver-cabinet-number" placeholder="输入待取件的编号" required>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="receiver-name">取件人姓名</label>
                                <input type="text" class="form-control" id="receiver-name" placeholder="输入取件人姓名" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="receiver-phone">联系电话</label>
                                <input type="tel" class="form-control" id="receiver-phone" placeholder="输入联系电话" required>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="receiver-id">身份证明号码后四位</label>
                            <input type="text" class="form-control" id="receiver-id" placeholder="输入身份证明号码后四位" maxlength="4" required>
                        </div>
                        
                        <input type="hidden" id="receiver-data-id">
                        
                        <div class="button-group">
                            <button type="submit" class="btn btn-primary">保存信息</button>
                            <button type="button" class="btn btn-secondary" id="receiver-form-cancel-btn">取消</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        
        <!-- 设置标签页 -->
        <div id="settings" class="tab-content">
            <h2 class="tab-title"><i class="fas fa-cog"></i> 系统设置</h2>
            
            <div class="password-protection" id="settings-password-section">
                <h3>设置管理</h3>
                <p>请输入管理密码以修改系统设置</p>
                <div class="password-form">
                    <input type="password" class="form-control" id="settings-password" placeholder="请输入管理密码">
                    <button class="btn btn-primary" id="settings-auth-btn">验证</button>
                </div>
            </div>
            
            <div id="settings-content" style="display: none;">
                <div class="settings-grid">
                    <div class="setting-item">
                        <h3>LOGO设置</h3>
                        <p>支持上传的格式为JPG、JPEG、PNG，尺寸为75cm*75cm</p>
                        
                        <div class="preview-area" id="logo-preview-area">
                            <span>LOGO预览</span>
                        </div>
                        
                        <div class="form-group">
                            <label for="logo-file">上传LOGO</label>
                            <input type="file" class="form-control" id="logo-file" accept=".jpg,.jpeg,.png">
                        </div>
                        
                        <div class="button-group">
                            <button class="btn btn-primary" id="logo-upload-btn">上传LOGO</button>
                            <button class="btn btn-danger" id="logo-delete-btn">删除LOGO</button>
                        </div>
                    </div>
                    
                    <div class="setting-item">
                        <h3>背景设置</h3>
                        <p>支持上传的格式为JPG、JPEG、PNG，将覆盖整个网页背景</p>
                        
                        <div class="preview-area" id="bg-preview-area">
                            <span>背景预览</span>
                        </div>
                        
                        <div class="form-group">
                            <label for="bg-file">上传背景</label>
                            <input type="file" class="form-control" id="bg-file" accept=".jpg,.jpeg,.png">
                        </div>
                        
                        <div class="button-group">
                            <button class="btn btn-primary" id="bg-upload-btn">上传背景</button>
                            <button class="btn btn-danger" id="bg-delete-btn">删除背景</button>
                        </div>
                    </div>
                </div>
                <!-- 管理工具区域 -->
                <div id="admin-tools" class="setting-item" style="margin-top: 30px; border-top: 2px solid #eee; padding-top: 20px;">
                    <h3>系统管理工具</h3>
                    <p>高级管理功能，请谨慎操作</p>
                    <div class="button-group">
                        <button class="btn btn-primary" onclick="exportAllData()">备份所有数据</button>
                        <button class="btn btn-secondary" onclick="importAllData()">恢复数据</button>
                        <button class="btn btn-danger" onclick="clearAllData()">清空所有数据</button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 戳戳我标签页 -->
        <div id="poke" class="tab-content">
            <h2 class="tab-title"><i class="fas fa-hand-point-up"></i> 戳戳我</h2>
            
            <div class="poke-image" id="poke-display">
                <div class="empty-message">暂无图片，请上传图片</div>
            </div>
            
            <div class="password-protection" id="poke-password-section">
                <h3>戳戳我管理</h3>
                <p>请输入管理密码以添加或修改图片</p>
                <div class="password-form">
                    <input type="password" class="form-control" id="poke-password" placeholder="请输入管理密码">
                    <button class="btn btn-primary" id="poke-auth-btn">验证</button>
                </div>
            </div>
            
            <div class="upload-form" id="poke-upload-form" style="display: none;">
                <h3 class="form-title">上传戳戳我图片</h3>
                <form id="poke-form">
                    <div class="form-group">
                        <label for="poke-file">图片文件 (JPG, JPEG, PNG)</label>
                        <input type="file" class="form-control" id="poke-file" accept=".jpg,.jpeg,.png" required>
                    </div>
                    
                    <input type="hidden" id="poke-id">
                    
                    <div class="button-group">
                        <button type="submit" class="btn btn-primary">上传图片</button>
                        <button type="button" class="btn btn-secondary" id="poke-cancel-btn">取消</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- 图片预览模态框 -->
    <div class="modal" id="image-modal">
        <button class="modal-close" id="modal-close">&times;</button>
        <div class="modal-content">
            <img id="modal-image" src="" alt="预览图片" class="modal-img">
        </div>
    </div>

    <script>
        // 全局变量
        const DEFAULT_PASSWORD = "740302";
        let currentTab = "notice";
        
        // 初始化函数
        document.addEventListener('DOMContentLoaded', function() {
            // 从本地存储加载当前标签页
            const savedTab = localStorage.getItem('currentTab');
            if (savedTab) {
                switchTab(savedTab);
            }
            
            // 加载所有数据
            loadAllData();
            
            // 设置标签页切换
            setupTabs();
            
            // 设置密码验证
            setupPasswordAuth();
            
            // 设置表单提交
            setupForms();
            
            // 设置图片预览
            setupImagePreview();
            
            // 设置取消按钮
            setupCancelButtons();
            
            // 设置弹窗功能
            setupPopups();
            
            // 初始化弹窗关闭按钮
            document.getElementById('modal-close').addEventListener('click', function() {
                document.getElementById('image-modal').classList.remove('active');
            });
        });
        
        // 标签页切换功能
        function setupTabs() {
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    switchTab(tabId);
                });
            });
        }
        
        function switchTab(tabId) {
            // 更新当前标签页
            currentTab = tabId;
            localStorage.setItem('currentTab', tabId);
            
            // 更新标签页样式
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`.tab[data-tab="${tabId}"]`).classList.add('active');
            
            // 更新内容显示
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(tabId).classList.add('active');
        }
        
        // 密码验证功能
        function setupPasswordAuth() {
            // 公告密码验证
            document.getElementById('notice-auth-btn').addEventListener('click', function() {
                const password = document.getElementById('notice-password').value;
                if (password === DEFAULT_PASSWORD) {
                    document.getElementById('notice-password-section').style.display = 'none';
                    document.getElementById('notice-upload-form').style.display = 'block';
                } else {
                    alert('密码错误！');
                    document.getElementById('notice-password').value = '';
                }
            });
            
            // 网点清单密码验证
            document.getElementById('network-auth-btn').addEventListener('click', function() {
                const password = document.getElementById('network-password').value;
                if (password === DEFAULT_PASSWORD) {
                    document.getElementById('network-password-section').style.display = 'none';
                    document.getElementById('network-upload-form').style.display = 'block';
                } else {
                    alert('密码错误！');
                    document.getElementById('network-password').value = '';
                }
            });
            
            // 资费清单密码验证
            document.getElementById('fee-auth-btn').addEventListener('click', function() {
                const password = document.getElementById('fee-password').value;
                if (password === DEFAULT_PASSWORD) {
                    document.getElementById('fee-password-section').style.display = 'none';
                    document.getElementById('fee-upload-form').style.display = 'block';
                } else {
                    alert('密码错误！');
                    document.getElementById('fee-password').value = '';
                }
            });
            
            // 设置密码验证
            document.getElementById('settings-auth-btn').addEventListener('click', function() {
                const password = document.getElementById('settings-password').value;
                if (password === DEFAULT_PASSWORD) {
                    document.getElementById('settings-password-section').style.display = 'none';
                    document.getElementById('settings-content').style.display = 'block';
                } else {
                    alert('密码错误！');
                    document.getElementById('settings-password').value = '';
                }
            });
            
            // 戳戳我密码验证
            document.getElementById('poke-auth-btn').addEventListener('click', function() {
                const password = document.getElementById('poke-password').value;
                if (password === DEFAULT_PASSWORD) {
                    document.getElementById('poke-password-section').style.display = 'none';
                    document.getElementById('poke-upload-form').style.display = 'block';
                } else {
                    alert('密码错误！');
                    document.getElementById('poke-password').value = '';
                }
            });
        }
        
        // 表单提交功能
        function setupForms() {
            // 公告表单
            document.getElementById('notice-form').addEventListener('submit', function(e) {
                e.preventDefault();
                saveNoticeData();
            });
            
            // 网点清单表单
            document.getElementById('network-form').addEventListener('submit', function(e) {
                e.preventDefault();
                saveNetworkData();
            });
            
            // 资费清单表单
            document.getElementById('fee-form').addEventListener('submit', function(e) {
                e.preventDefault();
                saveFeeData();
            });
            
            // 在柜信息表单
            document.getElementById('cabinet-form').addEventListener('submit', function(e) {
                e.preventDefault();
                saveCabinetData();
            });
            
            // 取件人信息表单
            document.getElementById('receiver-form').addEventListener('submit', function(e) {
                e.preventDefault();
                saveReceiverData();
            });
            
            // 戳戳我表单
            document.getElementById('poke-form').addEventListener('submit', function(e) {
                e.preventDefault();
                savePokeData();
            });
            
            // LOGO上传
            document.getElementById('logo-upload-btn').addEventListener('click', function() {
                uploadLogo();
            });
            
            // LOGO删除
            document.getElementById('logo-delete-btn').addEventListener('click', function() {
                deleteLogo();
            });
            
            // 背景上传
            document.getElementById('bg-upload-btn').addEventListener('click', function() {
                uploadBackground();
            });
            
            // 背景删除
            document.getElementById('bg-delete-btn').addEventListener('click', function() {
                deleteBackground();
            });
        }
        
        // 取消按钮功能
        function setupCancelButtons() {
            document.getElementById('notice-cancel-btn').addEventListener('click', function() {
                resetNoticeForm();
            });
            
            document.getElementById('network-cancel-btn').addEventListener('click', function() {
                resetNetworkForm();
            });
            
            document.getElementById('fee-cancel-btn').addEventListener('click', function() {
                resetFeeForm();
            });
            
            document.getElementById('poke-cancel-btn').addEventListener('click', function() {
                resetPokeForm();
            });
        }
        
        // 弹窗功能设置
        function setupPopups() {
            // 在柜信息弹窗
            const cabinetPopup = document.getElementById('cabinet-popup-form');
            const cabinetPopupClose = document.getElementById('cabinet-popup-close');
            const addCabinetBtn = document.getElementById('add-cabinet-btn');
            const cabinetFormCancelBtn = document.getElementById('cabinet-form-cancel-btn');
            
            addCabinetBtn.addEventListener('click', function() {
                cabinetPopup.style.display = 'flex';
                document.getElementById('cabinet-form').reset();
                document.getElementById('cabinet-data-id').value = '';
            });
            
            cabinetPopupClose.addEventListener('click', function() {
                cabinetPopup.style.display = 'none';
            });
            
            cabinetFormCancelBtn.addEventListener('click', function() {
                cabinetPopup.style.display = 'none';
            });
            
            // 取件人信息弹窗
            const receiverPopup = document.getElementById('receiver-popup-form');
            const receiverPopupClose = document.getElementById('receiver-popup-close');
            const addReceiverBtn = document.getElementById('add-receiver-btn');
            const receiverFormCancelBtn = document.getElementById('receiver-form-cancel-btn');
            
            addReceiverBtn.addEventListener('click', function() {
                receiverPopup.style.display = 'flex';
                document.getElementById('receiver-form').reset();
                document.getElementById('receiver-data-id').value = '';
            });
            
            receiverPopupClose.addEventListener('click', function() {
                receiverPopup.style.display = 'none';
            });
            
            receiverFormCancelBtn.addEventListener('click', function() {
                receiverPopup.style.display = 'none';
            });
            
            // 点击弹窗背景关闭
            cabinetPopup.addEventListener('click', function(e) {
                if (e.target === cabinetPopup) {
                    cabinetPopup.style.display = 'none';
                }
            });
            
            receiverPopup.addEventListener('click', function(e) {
                if (e.target === receiverPopup) {
                    receiverPopup.style.display = 'none';
                }
            });
        }
        
        // 图片预览功能
        function setupImagePreview() {
            const modal = document.getElementById('image-modal');
            const modalImage = document.getElementById('modal-image');
            
            // 点击模态框背景关闭
            modal.addEventListener('click', function(e) {
                if (e.target === modal) {
                    modal.classList.remove('active');
                }
            });
        }
        
        // 显示图片预览
        function showImagePreview(imageSrc) {
            const modal = document.getElementById('image-modal');
            const modalImage = document.getElementById('modal-image');
            
            modalImage.src = imageSrc;
            modal.classList.add('active');
        }
        
        // 生成唯一ID
        function generateId() {
            return Date.now().toString(36) + Math.random().toString(36).substr(2);
        }
        
        // 获取当前时间
        function getCurrentDateTime() {
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            
            return `${year}年${month}月${day}日 ${hours}:${minutes}`;
        }
        
        // 加载所有数据
        function loadAllData() {
            loadNoticeData();
            loadNetworkData();
            loadFeeData();
            loadCabinetData();
            loadReceiverData();
            loadPokeData();
            loadSettings();
        }
        
        // 加载公告数据
        function loadNoticeData() {
            const noticeData = JSON.parse(localStorage.getItem('noticeData') || '[]');
            const noticeDisplay = document.getElementById('notice-display');
            
            if (noticeData.length === 0) {
                noticeDisplay.innerHTML = '<div class="empty-message">暂无公告，请上传公告图片</div>';
                return;
            }
            
            let html = '<div class="image-grid">';
            
            noticeData.forEach(item => {
                html += `
                <div class="image-item" data-id="${item.id}">
                    <img src="${item.image}" alt="${item.title}" class="item-img" onclick="showImagePreview('${item.image}')">
                    <div class="item-info">
                        <div class="item-title">${item.title}</div>
                        <div class="item-detail">上传日期: ${item.uploadDate}</div>
                        <div class="action-buttons">
                            <button class="btn btn-primary btn-small" onclick="editNotice('${item.id}')">编辑</button>
                            <button class="btn btn-danger btn-small" onclick="deleteNotice('${item.id}')">删除</button>
                        </div>
                    </div>
                </div>
                `;
            });
            
            html += '</div>';
            noticeDisplay.innerHTML = html;
        }
        
        // 保存公告数据
        function saveNoticeData() {
            const fileInput = document.getElementById('notice-file');
            const title = document.getElementById('notice-title').value;
            const id = document.getElementById('notice-id').value;
            
            if (!title) {
                alert('请填写公告标题！');
                return;
            }
            
            if (!fileInput.files[0] && !id) {
                alert('请选择图片文件！');
                return;
            }
            
            // 检查文件数量
            const files = fileInput.files;
            if (files.length > 5) {
                alert('最多只能上传5张图片！');
                return;
            }
            
            const noticeData = JSON.parse(localStorage.getItem('noticeData') || '[]');
            const uploadDate = getCurrentDateTime();
            
            // 处理多个文件
            const processFiles = (fileList) => {
                const results = [];
                
                for (let i = 0; i < fileList.length; i++) {
                    const file = fileList[i];
                    const reader = new FileReader();
                    
                    reader.onload = function(e) {
                        results.push({
                            id: generateId(),
                            title: title + (fileList.length > 1 ? ` (${i+1})` : ''),
                            image: e.target.result,
                            uploadDate
                        });
                        
                        if (results.length === fileList.length) {
                            // 所有文件读取完成
                            if (id) {
                                // 编辑模式 - 替换现有项
                                const index = noticeData.findIndex(item => item.id === id);
                                if (index !== -1) {
                                    noticeData[index] = results[0];
                                }
                            } else {
                                // 新增模式 - 添加所有图片
                                noticeData.push(...results);
                            }
                            
                            // 限制最多保存5条
                            const limitedData = noticeData.slice(-5);
                            
                            localStorage.setItem('noticeData', JSON.stringify(limitedData));
                            resetNoticeForm();
                            loadNoticeData();
                            alert(id ? '公告已更新！' : '公告已上传！');
                        }
                    };
                    
                    reader.readAsDataURL(file);
                }
            };
            
            if (files.length > 0) {
                processFiles(files);
            } else if (id) {
                // 没有新图片，只更新其他信息
                const index = noticeData.findIndex(item => item.id === id);
                if (index !== -1) {
                    noticeData[index] = {
                        ...noticeData[index],
                        title,
                        uploadDate: getCurrentDateTime()
                    };
                    
                    localStorage.setItem('noticeData', JSON.stringify(noticeData));
                    resetNoticeForm();
                    loadNoticeData();
                    alert('公告信息已更新！');
                }
            }
        }
        
        // 编辑公告
        function editNotice(id) {
            const noticeData = JSON.parse(localStorage.getItem('noticeData') || '[]');
            const item = noticeData.find(item => item.id === id);
            
            if (item) {
                document.getElementById('notice-title').value = item.title;
                document.getElementById('notice-id').value = item.id;
                
                // 显示表单
                document.getElementById('notice-password-section').style.display = 'none';
                document.getElementById('notice-upload-form').style.display = 'block';
            }
        }
        
        // 删除公告
        function deleteNotice(id) {
            if (confirm('确定要删除这条公告吗？')) {
                const noticeData = JSON.parse(localStorage.getItem('noticeData') || '[]');
                const newData = noticeData.filter(item => item.id !== id);
                localStorage.setItem('noticeData', JSON.stringify(newData));
                loadNoticeData();
            }
        }
        
        // 重置公告表单
        function resetNoticeForm() {
            document.getElementById('notice-form').reset();
            document.getElementById('notice-id').value = '';
            document.getElementById('notice-upload-form').style.display = 'none';
            document.getElementById('notice-password-section').style.display = 'block';
            document.getElementById('notice-password').value = '';
        }
        
        // 加载网点清单数据
        function loadNetworkData() {
            const networkData = JSON.parse(localStorage.getItem('networkData') || '[]');
            const networkDisplay = document.getElementById('network-display');
            
            if (networkData.length === 0) {
                networkDisplay.innerHTML = '<div class="empty-message">暂无网点清单，请上传网点清单图片</div>';
                return;
            }
            
            let html = '<div class="image-grid">';
            
            networkData.forEach((item, index) => {
                html += `
                <div class="image-item" data-id="${item.id}">
                    <img src="${item.image}" alt="网点清单图片 ${index+1}" class="item-img" onclick="showImagePreview('${item.image}')">
                    <div class="item-info">
                        <div class="item-title">网点清单图片 ${index+1}</div>
                        <div class="item-detail">上传日期: ${item.uploadDate}</div>
                        <div class="action-buttons">
                            <button class="btn btn-primary btn-small" onclick="editNetwork('${item.id}')">编辑</button>
                            <button class="btn btn-danger btn-small" onclick="deleteNetwork('${item.id}')">删除</button>
                        </div>
                    </div>
                </div>
                `;
            });
            
            html += '</div>';
            networkDisplay.innerHTML = html;
        }
        
        // 保存网点清单数据
        function saveNetworkData() {
            const fileInput = document.getElementById('network-file');
            const id = document.getElementById('network-id').value;
            
            if (!fileInput.files[0] && !id) {
                alert('请选择图片文件！');
                return;
            }
            
            // 检查文件数量
            const files = fileInput.files;
            if (files.length > 5) {
                alert('最多只能上传5张图片！');
                return;
            }
            
            const networkData = JSON.parse(localStorage.getItem('networkData') || '[]');
            const uploadDate = getCurrentDateTime();
            
            // 处理多个文件
            const processFiles = (fileList) => {
                const results = [];
                
                for (let i = 0; i < fileList.length; i++) {
                    const file = fileList[i];
                    const reader = new FileReader();
                    
                    reader.onload = function(e) {
                        results.push({
                            id: generateId(),
                            image: e.target.result,
                            uploadDate
                        });
                        
                        if (results.length === fileList.length) {
                            // 所有文件读取完成
                            if (id) {
                                // 编辑模式 - 替换现有项
                                const index = networkData.findIndex(item => item.id === id);
                                if (index !== -1) {
                                    networkData[index] = results[0];
                                }
                            } else {
                                // 新增模式 - 添加所有图片
                                networkData.push(...results);
                            }
                            
                            // 限制最多保存5条
                            const limitedData = networkData.slice(-5);
                            
                            localStorage.setItem('networkData', JSON.stringify(limitedData));
                            resetNetworkForm();
                            loadNetworkData();
                            alert(id ? '网点清单已更新！' : '网点清单已上传！');
                        }
                    };
                    
                    reader.readAsDataURL(file);
                }
            };
            
            if (files.length > 0) {
                processFiles(files);
            } else if (id) {
                // 没有新图片，只更新上传日期
                const index = networkData.findIndex(item => item.id === id);
                if (index !== -1) {
                    networkData[index] = {
                        ...networkData[index],
                        uploadDate: getCurrentDateTime()
                    };
                    
                    localStorage.setItem('networkData', JSON.stringify(networkData));
                    resetNetworkForm();
                    loadNetworkData();
                    alert('网点清单信息已更新！');
                }
            }
        }
        
        // 编辑网点清单
        function editNetwork(id) {
            const networkData = JSON.parse(localStorage.getItem('networkData') || '[]');
            const item = networkData.find(item => item.id === id);
            
            if (item) {
                document.getElementById('network-id').value = item.id;
                
                // 显示表单
                document.getElementById('network-password-section').style.display = 'none';
                document.getElementById('network-upload-form').style.display = 'block';
            }
        }
        
        // 删除网点清单
        function deleteNetwork(id) {
            if (confirm('确定要删除这条网点清单吗？')) {
                const networkData = JSON.parse(localStorage.getItem('networkData') || '[]');
                const newData = networkData.filter(item => item.id !== id);
                localStorage.setItem('networkData', JSON.stringify(newData));
                loadNetworkData();
            }
        }
        
        // 重置网点清单表单
        function resetNetworkForm() {
            document.getElementById('network-form').reset();
            document.getElementById('network-id').value = '';
            document.getElementById('network-upload-form').style.display = 'none';
            document.getElementById('network-password-section').style.display = 'block';
            document.getElementById('network-password').value = '';
        }
        
        // 加载资费清单数据
        function loadFeeData() {
            const feeData = JSON.parse(localStorage.getItem('feeData') || '[]');
            const feeDisplay = document.getElementById('fee-display');
            
            if (feeData.length === 0) {
                feeDisplay.innerHTML = '<div class="empty-message">暂无资费清单，请上传资费清单图片</div>';
                return;
            }
            
            let html = '<div class="image-grid">';
            
            feeData.forEach((item, index) => {
                html += `
                <div class="image-item" data-id="${item.id}">
                    <img src="${item.image}" alt="资费清单图片 ${index+1}" class="item-img" onclick="showImagePreview('${item.image}')">
                    <div class="item-info">
                        <div class="item-title">资费清单图片 ${index+1}</div>
                        <div class="item-detail">上传日期: ${item.uploadDate}</div>
                        <div class="action-buttons">
                            <button class="btn btn-primary btn-small" onclick="editFee('${item.id}')">编辑</button>
                            <button class="btn btn-danger btn-small" onclick="deleteFee('${item.id}')">删除</button>
                        </div>
                    </div>
                </div>
                `;
            });
            
            html += '</div>';
            feeDisplay.innerHTML = html;
        }
        
        // 保存资费清单数据
        function saveFeeData() {
            const fileInput = document.getElementById('fee-file');
            const id = document.getElementById('fee-id').value;
            
            if (!fileInput.files[0] && !id) {
                alert('请选择图片文件！');
                return;
            }
            
            // 检查文件数量
            const files = fileInput.files;
            if (files.length > 5) {
                alert('最多只能上传5张图片！');
                return;
            }
            
            const feeData = JSON.parse(localStorage.getItem('feeData') || '[]');
            const uploadDate = getCurrentDateTime();
            
            // 处理多个文件
            const processFiles = (fileList) => {
                const results = [];
                
                for (let i = 0; i < fileList.length; i++) {
                    const file = fileList[i];
                    const reader = new FileReader();
                    
                    reader.onload = function(e) {
                        results.push({
                            id: generateId(),
                            image: e.target.result,
                            uploadDate
                        });
                        
                        if (results.length === fileList.length) {
                            // 所有文件读取完成
                            if (id) {
                                // 编辑模式 - 替换现有项
                                const index = feeData.findIndex(item => item.id === id);
                                if (index !== -1) {
                                    feeData[index] = results[0];
                                }
                            } else {
                                // 新增模式 - 添加所有图片
                                feeData.push(...results);
                            }
                            
                            // 限制最多保存5条
                            const limitedData = feeData.slice(-5);
                            
                            localStorage.setItem('feeData', JSON.stringify(limitedData));
                            resetFeeForm();
                            loadFeeData();
                            alert(id ? '资费清单已更新！' : '资费清单已上传！');
                        }
                    };
                    
                    reader.readAsDataURL(file);
                }
            };
            
            if (files.length > 0) {
                processFiles(files);
            } else if (id) {
                // 没有新图片，只更新上传日期
                const index = feeData.findIndex(item => item.id === id);
                if (index !== -1) {
                    feeData[index] = {
                        ...feeData[index],
                        uploadDate: getCurrentDateTime()
                    };
                    
                    localStorage.setItem('feeData', JSON.stringify(feeData));
                    resetFeeForm();
                    loadFeeData();
                    alert('资费清单信息已更新！');
                }
            }
        }
        
        // 编辑资费清单
        function editFee(id) {
            const feeData = JSON.parse(localStorage.getItem('feeData') || '[]');
            const item = feeData.find(item => item.id === id);
            
            if (item) {
                document.getElementById('fee-id').value = item.id;
                
                // 显示表单
                document.getElementById('fee-password-section').style.display = 'none';
                document.getElementById('fee-upload-form').style.display = 'block';
            }
        }
        
        // 删除资费清单
        function deleteFee(id) {
            if (confirm('确定要删除这条资费清单吗？')) {
                const feeData = JSON.parse(localStorage.getItem('feeData') || '[]');
                const newData = feeData.filter(item => item.id !== id);
                localStorage.setItem('feeData', JSON.stringify(newData));
                loadFeeData();
            }
        }
        
        // 重置资费清单表单
        function resetFeeForm() {
            document.getElementById('fee-form').reset();
            document.getElementById('fee-id').value = '';
            document.getElementById('fee-upload-form').style.display = 'none';
            document.getElementById('fee-password-section').style.display = 'block';
            document.getElementById('fee-password').value = '';
        }
        
        // 加载在柜信息数据
        function loadCabinetData() {
            const cabinetData = JSON.parse(localStorage.getItem('cabinetData') || '[]');
            const cabinetDisplay = document.getElementById('cabinet-display');
            
            if (cabinetData.length === 0) {
                cabinetDisplay.innerHTML = '<div class="empty-message">等待数据上传</div>';
                return;
            }
            
            let html = `
            <table class="data-table">
                <thead>
                    <tr>
                        <th>区域</th>
                        <th>大区</th>
                        <th>编号</th>
                        <th>类型</th>
                        <th>存放位置</th>
                        <th>状态</th>
                        <th>操作</th>
                    </tr>
                </thead>
                <tbody>
            `;
            
            cabinetData.forEach(item => {
                const statusClass = item.status === '已入柜' ? 'status-in' : 'status-out';
                
                html += `
                <tr data-id="${item.id}">
                    <td>${item.area}</td>
                    <td>${item.region}</td>
                    <td>${item.number}</td>
                    <td><span class="type-badge">${item.type}</span></td>
                    <td>${item.location}</td>
                    <td><span class="status-badge ${statusClass}">${item.status}</span></td>
                    <td>
                        <button class="btn btn-primary btn-small" onclick="editCabinet('${item.id}')">编辑</button>
                        <button class="btn btn-danger btn-small" onclick="deleteCabinet('${item.id}')">删除</button>
                    </td>
                </tr>
                `;
            });
            
            html += '</tbody></table>';
            cabinetDisplay.innerHTML = html;
        }
        
        // 保存在柜信息数据
        function saveCabinetData() {
            const area = document.getElementById('cabinet-area').value;
            const region = document.getElementById('cabinet-region').value;
            const number = document.getElementById('cabinet-number').value;
            const type = document.getElementById('cabinet-type').value;
            const location = document.getElementById('cabinet-location').value;
            const status = document.getElementById('cabinet-status').value;
            const id = document.getElementById('cabinet-data-id').value;
            
            if (!area || !region || !number || !type || !location || !status) {
                alert('请填写所有字段！');
                return;
            }
            
            const cabinetData = JSON.parse(localStorage.getItem('cabinetData') || '[]');
            
            if (id) {
                // 编辑模式
                const index = cabinetData.findIndex(item => item.id === id);
                if (index !== -1) {
                    cabinetData[index] = {
                        ...cabinetData[index],
                        area,
                        region,
                        number,
                        type,
                        location,
                        status
                    };
                }
            } else {
                // 新增模式
                cabinetData.push({
                    id: generateId(),
                    area,
                    region,
                    number,
                    type,
                    location,
                    status
                });
            }
            
            localStorage.setItem('cabinetData', JSON.stringify(cabinetData));
            
            // 关闭弹窗
            document.getElementById('cabinet-popup-form').style.display = 'none';
            
            loadCabinetData();
            alert(id ? '在柜信息已更新！' : '在柜信息已保存！');
        }
        
        // 编辑在柜信息
        function editCabinet(id) {
            const cabinetData = JSON.parse(localStorage.getItem('cabinetData') || '[]');
            const item = cabinetData.find(item => item.id === id);
            
            if (item) {
                document.getElementById('cabinet-area').value = item.area;
                document.getElementById('cabinet-region').value = item.region;
                document.getElementById('cabinet-number').value = item.number;
                document.getElementById('cabinet-type').value = item.type;
                document.getElementById('cabinet-location').value = item.location;
                document.getElementById('cabinet-status').value = item.status;
                document.getElementById('cabinet-data-id').value = item.id;
                
                // 显示弹窗
                document.getElementById('cabinet-popup-form').style.display = 'flex';
            }
        }
        
        // 删除在柜信息
        function deleteCabinet(id) {
            if (confirm('确定要删除这条在柜信息吗？')) {
                const cabinetData = JSON.parse(localStorage.getItem('cabinetData') || '[]');
                const newData = cabinetData.filter(item => item.id !== id);
                localStorage.setItem('cabinetData', JSON.stringify(newData));
                loadCabinetData();
            }
        }
        
        // 加载取件人信息数据
        function loadReceiverData() {
            const receiverData = JSON.parse(localStorage.getItem('receiverData') || '[]');
            const receiverDisplay = document.getElementById('receiver-display');
            
            if (receiverData.length === 0) {
                receiverDisplay.innerHTML = '<div class="empty-message">等待数据上传</div>';
                return;
            }
            
            let html = `
            <table class="data-table">
                <thead>
                    <tr>
                        <th>待取件编号</th>
                        <th>取件人姓名</th>
                        <th>联系电话</th>
                        <th>身份证明后四位</th>
                        <th>操作</th>
                    </tr>
                </thead>
                <tbody>
            `;
            
            receiverData.forEach(item => {
                html += `
                <tr data-id="${item.id}">
                    <td>${item.cabinetNumber}</td>
                    <td>${item.name}</td>
                    <td>${item.phone}</td>
                    <td>${item.idNumber}</td>
                    <td>
                        <button class="btn btn-primary btn-small" onclick="editReceiver('${item.id}')">编辑</button>
                        <button class="btn btn-danger btn-small" onclick="deleteReceiver('${item.id}')">删除</button>
                    </td>
                </tr>
                `;
            });
            
            html += '</tbody></table>';
            receiverDisplay.innerHTML = html;
        }
        
        // 保存取件人信息数据
        function saveReceiverData() {
            const cabinetNumber = document.getElementById('receiver-cabinet-number').value;
            const name = document.getElementById('receiver-name').value;
            const phone = document.getElementById('receiver-phone').value;
            const idNumber = document.getElementById('receiver-id').value;
            const receiverId = document.getElementById('receiver-data-id').value;
            
            if (!cabinetNumber || !name || !phone || !idNumber) {
                alert('请填写所有字段！');
                return;
            }
            
            if (idNumber.length !== 4) {
                alert('身份证明号码后四位必须是4位数字！');
                return;
            }
            
            const receiverData = JSON.parse(localStorage.getItem('receiverData') || '[]');
            
            if (receiverId) {
                // 编辑模式
                const index = receiverData.findIndex(item => item.id === receiverId);
                if (index !== -1) {
                    receiverData[index] = {
                        ...receiverData[index],
                        cabinetNumber,
                        name,
                        phone,
                        idNumber
                    };
                }
            } else {
                // 新增模式
                receiverData.push({
                    id: generateId(),
                    cabinetNumber,
                    name,
                    phone,
                    idNumber
                });
            }
            
            localStorage.setItem('receiverData', JSON.stringify(receiverData));
            
            // 关闭弹窗
            document.getElementById('receiver-popup-form').style.display = 'none';
            
            loadReceiverData();
            alert(receiverId ? '取件人信息已更新！' : '取件人信息已保存！');
        }
        
        // 编辑取件人信息
        function editReceiver(id) {
            const receiverData = JSON.parse(localStorage.getItem('receiverData') || '[]');
            const item = receiverData.find(item => item.id === id);
            
            if (item) {
                document.getElementById('receiver-cabinet-number').value = item.cabinetNumber;
                document.getElementById('receiver-name').value = item.name;
                document.getElementById('receiver-phone').value = item.phone;
                document.getElementById('receiver-id').value = item.idNumber;
                document.getElementById('receiver-data-id').value = item.id;
                
                // 显示弹窗
                document.getElementById('receiver-popup-form').style.display = 'flex';
            }
        }
        
        // 删除取件人信息
        function deleteReceiver(id) {
            if (confirm('确定要删除这条取件人信息吗？')) {
                const receiverData = JSON.parse(localStorage.getItem('receiverData') || '[]');
                const newData = receiverData.filter(item => item.id !== id);
                localStorage.setItem('receiverData', JSON.stringify(newData));
                loadReceiverData();
            }
        }
        
        // 加载戳戳我数据
        function loadPokeData() {
            const pokeData = JSON.parse(localStorage.getItem('pokeData') || '[]');
            const pokeDisplay = document.getElementById('poke-display');
            
            if (pokeData.length === 0) {
                pokeDisplay.innerHTML = '<div class="empty-message">暂无图片，请上传图片</div>';
                return;
            }
            
            // 只显示最新的一张图片
            const latestPoke = pokeData[pokeData.length - 1];
            
            let html = `
            <div class="poke-image-item" data-id="${latestPoke.id}">
                <img src="${latestPoke.image}" alt="戳戳我图片" style="max-width: 300px; max-height: 300px; border-radius: 10px; cursor: pointer;" onclick="showImagePreview('${latestPoke.image}')">
                <div class="item-detail" style="text-align: center; margin-top: 10px;">上传日期: ${latestPoke.uploadDate}</div>
                <div class="action-buttons" style="justify-content: center; margin-top: 10px;">
                    <button class="btn btn-primary btn-small" onclick="editPoke('${latestPoke.id}')">编辑</button>
                    <button class="btn btn-danger btn-small" onclick="deletePoke('${latestPoke.id}')">删除</button>
                </div>
            </div>
            `;
            
            pokeDisplay.innerHTML = html;
        }
        
        // 保存戳戳我数据
        function savePokeData() {
            const fileInput = document.getElementById('poke-file');
            const id = document.getElementById('poke-id').value;
            
            if (!fileInput.files[0] && !id) {
                alert('请选择图片文件！');
                return;
            }
            
            if (fileInput.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const pokeData = JSON.parse(localStorage.getItem('pokeData') || '[]');
                    const uploadDate = getCurrentDateTime();
                    
                    if (id) {
                        // 编辑模式
                        const index = pokeData.findIndex(item => item.id === id);
                        if (index !== -1) {
                            pokeData[index] = {
                                ...pokeData[index],
                                image: e.target.result,
                                uploadDate
                            };
                        }
                    } else {
                        // 新增模式
                        pokeData.push({
                            id: generateId(),
                            image: e.target.result,
                            uploadDate
                        });
                    }
                    
                    localStorage.setItem('pokeData', JSON.stringify(pokeData));
                    resetPokeForm();
                    loadPokeData();
                    alert(id ? '图片已更新！' : '图片已上传！');
                };
                reader.readAsDataURL(fileInput.files[0]);
            }
        }
        
        // 编辑戳戳我
        function editPoke(id) {
            const pokeData = JSON.parse(localStorage.getItem('pokeData') || '[]');
            const item = pokeData.find(item => item.id === id);
            
            if (item) {
                document.getElementById('poke-id').value = item.id;
                
                // 显示表单
                document.getElementById('poke-password-section').style.display = 'none';
                document.getElementById('poke-upload-form').style.display = 'block';
            }
        }
        
        // 删除戳戳我
        function deletePoke(id) {
            if (confirm('确定要删除这张图片吗？')) {
                const pokeData = JSON.parse(localStorage.getItem('pokeData') || '[]');
                const newData = pokeData.filter(item => item.id !== id);
                localStorage.setItem('pokeData', JSON.stringify(newData));
                loadPokeData();
                alert('图片已删除！');
            }
        }
        
        // 重置戳戳我表单
        function resetPokeForm() {
            document.getElementById('poke-form').reset();
            document.getElementById('poke-id').value = '';
            document.getElementById('poke-upload-form').style.display = 'none';
            document.getElementById('poke-password-section').style.display = 'block';
            document.getElementById('poke-password').value = '';
        }
        
        // 加载设置
        function loadSettings() {
            // 加载LOGO
            const logoData = localStorage.getItem('siteLogo');
            if (logoData) {
                const logoPreview = document.getElementById('logo-preview-area');
                const headerLogo = document.getElementById('logo-preview');
                
                logoPreview.innerHTML = `<img src="${logoData}" alt="LOGO" style="max-width:100%; max-height:100%;">`;
                
                if (headerLogo.classList.contains('logo-placeholder')) {
                    headerLogo.classList.remove('logo-placeholder');
                    headerLogo.classList.add('logo');
                    headerLogo.innerHTML = '';
                    const img = document.createElement('img');
                    img.src = logoData;
                    img.alt = 'LOGO';
                    img.style.width = '100%';
                    img.style.height = '100%';
                    img.style.objectFit = 'cover';
                    img.style.borderRadius = '10px';
                    headerLogo.appendChild(img);
                    
                    // 点击LOGO可以查看大图
                    headerLogo.onclick = function() {
                        showImagePreview(logoData);
                    };
                }
            }
            
            // 加载背景
            const bgData = localStorage.getItem('siteBackground');
            if (bgData) {
                document.body.style.backgroundImage = `url(${bgData})`;
                document.body.style.backgroundSize = 'cover';
                document.body.style.backgroundPosition = 'center';
                document.body.style.backgroundAttachment = 'fixed';
                
                const bgPreview = document.getElementById('bg-preview-area');
                bgPreview.innerHTML = `<img src="${bgData}" alt="背景预览" style="max-width:100%; max-height:100%;">`;
            }
        }
        
        // 上传LOGO
        function uploadLogo() {
            const fileInput = document.getElementById('logo-file');
            if (!fileInput.files[0]) {
                alert('请选择LOGO文件！');
                return;
            }
            
            const file = fileInput.files[0];
            const reader = new FileReader();
            
            reader.onload = function(e) {
                localStorage.setItem('siteLogo', e.target.result);
                loadSettings();
                alert('LOGO上传成功！');
                fileInput.value = '';
            };
            
            reader.readAsDataURL(file);
        }
        
        // 删除LOGO
        function deleteLogo() {
            if (confirm('确定要删除LOGO吗？')) {
                localStorage.removeItem('siteLogo');
                loadSettings();
                alert('LOGO已删除！');
            }
        }
        
        // 上传背景
        function uploadBackground() {
            const fileInput = document.getElementById('bg-file');
            if (!fileInput.files[0]) {
                alert('请选择背景文件！');
                return;
            }
            
            const file = fileInput.files[0];
            const reader = new FileReader();
            
            reader.onload = function(e) {
                localStorage.setItem('siteBackground', e.target.result);
                loadSettings();
                alert('背景上传成功！');
                fileInput.value = '';
            };
            
            reader.readAsDataURL(file);
        }
        
        // 删除背景
        function deleteBackground() {
            if (confirm('确定要删除背景吗？')) {
                localStorage.removeItem('siteBackground');
                document.body.style.backgroundImage = '';
                document.body.style.backgroundColor = '#f5f7fa';
                
                const bgPreview = document.getElementById('bg-preview-area');
                bgPreview.innerHTML = '<span>背景预览</span>';
                
                alert('背景已删除！');
            }
        }
        
        // 数据导出功能
        function exportAllData() {
            const allData = {
                noticeData: JSON.parse(localStorage.getItem('noticeData') || '[]'),
                networkData: JSON.parse(localStorage.getItem('networkData') || '[]'),
                feeData: JSON.parse(localStorage.getItem('feeData') || '[]'),
                cabinetData: JSON.parse(localStorage.getItem('cabinetData') || '[]'),
                receiverData: JSON.parse(localStorage.getItem('receiverData') || '[]'),
                pokeData: JSON.parse(localStorage.getItem('pokeData') || '[]'),
                siteLogo: localStorage.getItem('siteLogo') || '',
                siteBackground: localStorage.getItem('siteBackground') || '',
                exportDate: new Date().toLocaleString('zh-CN')
            };
            
            const dataStr = JSON.stringify(allData, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);
            
            const exportFileDefaultName = `里昂星储备份_${new Date().toISOString().split('T')[0]}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
            
            alert('数据备份成功！文件已下载。');
        }
        
        // 数据导入功能
        function importAllData() {
            if (!confirm('导入数据将覆盖当前所有数据，确定要继续吗？')) {
                return;
            }
            
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = function(e) {
                const file = e.target.files[0];
                const reader = new FileReader();
                
                reader.onload = function(event) {
                    try {
                        const data = JSON.parse(event.target.result);
                        
                        // 验证数据格式
                        if (data.noticeData) localStorage.setItem('noticeData', JSON.stringify(data.noticeData));
                        if (data.networkData) localStorage.setItem('networkData', JSON.stringify(data.networkData));
                        if (data.feeData) localStorage.setItem('feeData', JSON.stringify(data.feeData));
                        if (data.cabinetData) localStorage.setItem('cabinetData', JSON.stringify(data.cabinetData));
                        if (data.receiverData) localStorage.setItem('receiverData', JSON.stringify(data.receiverData));
                        if (data.pokeData) localStorage.setItem('pokeData', JSON.stringify(data.pokeData));
                        if (data.siteLogo) localStorage.setItem('siteLogo', data.siteLogo);
                        if (data.siteBackground) localStorage.setItem('siteBackground', data.siteBackground);
                        
                        // 重新加载所有数据
                        loadAllData();
                        alert('数据导入成功！');
                    } catch (err) {
                        alert('文件格式错误或已损坏！');
                        console.error('数据导入错误:', err);
                    }
                };
                
                reader.readAsText(file);
            };
            
            input.click();
        }
        
        // 清空所有数据
        function clearAllData() {
            if (!confirm('确定要清空所有数据吗？此操作不可恢复！')) {
                return;
            }
            
            localStorage.clear();
            
            // 重新加载页面
            location.reload();
        }
        
        // 页面加载完成后的初始化
        window.addEventListener('load', function() {
            // 加载所有数据
            loadAllData();
            
            // 添加键盘快捷键
            document.addEventListener('keydown', function(e) {
                // Ctrl + S 保存当前表单
                if (e.ctrlKey && e.key === 's') {
                    e.preventDefault();
                    
                    switch(currentTab) {
                        case 'notice':
                            if (document.getElementById('notice-upload-form').style.display !== 'none') {
                                document.getElementById('notice-form').dispatchEvent(new Event('submit'));
                            }
                            break;
                        case 'network':
                            if (document.getElementById('network-upload-form').style.display !== 'none') {
                                document.getElementById('network-form').dispatchEvent(new Event('submit'));
                            }
                            break;
                        case 'fee':
                            if (document.getElementById('fee-upload-form').style.display !== 'none') {
                                document.getElementById('fee-form').dispatchEvent(new Event('submit'));
                            }
                            break;
                        case 'cabinet':
                            // 如果在柜信息弹窗打开
                            if (document.getElementById('cabinet-popup-form').style.display === 'flex') {
                                document.getElementById('cabinet-form').dispatchEvent(new Event('submit'));
                            }
                            break;
                        case 'poke':
                            if (document.getElementById('poke-upload-form').style.display !== 'none') {
                                document.getElementById('poke-form').dispatchEvent(new Event('submit'));
                            }
                            break;
                    }
                }
                
                // Esc 键关闭弹窗
                if (e.key === 'Escape') {
                    const cabinetPopup = document.getElementById('cabinet-popup-form');
                    const receiverPopup = document.getElementById('receiver-popup-form');
                    const imageModal = document.getElementById('image-modal');
                    
                    if (cabinetPopup.style.display === 'flex') {
                        cabinetPopup.style.display = 'none';
                    }
                    
                    if (receiverPopup.style.display === 'flex') {
                        receiverPopup.style.display = 'none';
                    }
                    
                    if (imageModal.classList.contains('active')) {
                        imageModal.classList.remove('active');
                    }
                }
            });
            
            // 显示欢迎信息
            console.log('里昂星储查询系统已启动！');
            console.log('系统功能包括：公告管理、网点清单、资费清单、在柜信息管理、取件人信息管理、戳戳我图片管理等');
            console.log('默认管理密码：740302');
        });
    </script>
</body>
</html>